function egretOverride(){window.cacheMeasureData={},egret.TextField.prototype.$setText=function(t){this.$TextField[2067]=0,t||(t=""),"number"==typeof t&&(t=t.toString());var e=window.cacheMeasureData;if(e[t]&&e[t].arr){var i=this.$measuredCallBack(e[t].arr,e[t].result);return this.$setTextAfterMeasure(i),!0}var n=this.$beforeMeasuredText(t);if("function"==typeof htgPlatSdk.getTextWidth){e[t]={};var r=this;htgPlatSdk.getTextWidth(n,r.fontFamily||"SimHei",r.size||20,r.bold||!1,r.italic||!1).then(function(i){var s=JSON.parse(i);e[t].arr=n,e[t].result=s;var o=r.$measuredCallBack(n,s);r.$setTextAfterMeasure(o)})}else{for(var s=[],o=0;o<n.length;o++)s.push(this.$measuredWidth(n[o]||""));var i=this.$measuredCallBack(n,s);this.$setTextAfterMeasure(i)}return!0},egret.TextField.prototype.$beforeMeasuredText=function(t){t=t.replace(/^[ ]+/g,""),t=t.replace(/[ ]+$/g,"");for(var e=[],i=t.split(/[\n]+/g),n=0;n<i.length;n++)i[n]=i[n].replace(/^[ ]+/g,""),i[n]=i[n].replace(/[ ]+$/g,""),e.push(i[n]),e=e.concat(i[n].split(/[<]+[^<^>]*[^<^>]*[>]+|[ ]+/g));return e.unshift(" "),e.unshift(t),e},egret.TextField.prototype.$measuredCallBack=function(t,e){if(t.length==e.length){for(var i={},n=0;n<t.length;n++)i[t[n]]=e[n];var r=t[0];if(!this.isNoSet&&this.$TextField[3]&&this.$TextField[3]<i[r]){var s=r.split(/[\n]+/g),o=r.split(/[^\n]+/g);o[0]||o.shift();for(var a=s.length,h=0;a>h;h++)s[h]=s[h].replace(/^[ ]+/g,""),s[h]=s[h].replace(/[ ]+$/g,""),s[h]=this.$fixOneline(s[h],i),s[h]=s[h]+(o[h]||""),s[h]=this.$checkFirstCode(s[h]);r=s.join("")}else r=this.$checkFirstCode(r);return r}return""},egret.TextField.prototype.$checkFirstCode=function(t){var e=t.charCodeAt(0);return 8295!=e&&(t="⁧"+t,this.$TextField[2067]+=1),t},egret.TextField.prototype.$setTextAfterMeasure=function(t){var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),this.$TextField[19]||this.$TextField[998]||(this.$TextField[19]=!0),e},egret.TextField.prototype.$measuredWidth=function(t){return LoadingConst.IS_NATIVE?this.$TextField[3]:egret.sys.measureText(t,this.fontFamily||"SimHei",this.size||20,this.bold||!1,this.italic||!1)},egret.TextField.prototype.$fixOneline=function(t,e){var i=e[t]||0;if(this.$TextField[3]&&this.$TextField[3]<i){for(var n=this.$TextField[3],r=t.split(/[<]+[^<^>]*[^<^>]*[>]+|[ ]+/g),s=0,o=0,a=e[" "]||0,h=r.length,l=0;h>l;l++)if(s=e[r[l]]||0,o>0&&(s+=a),o+=s,s>n){if(o=0,l>0&&(r[l-1]=r[l-1]+"\n"),h>l+1){var c=r[l+1].charCodeAt(0);if(8295!=c){var d=e[r[l+1]];r[l+1]="⁧"+r[l+1],e[r[l+1]]=d,this.$TextField[2067]+=1}}r[l]=r[l]+"\n"}else if(o>n){var c=r[l].charCodeAt(0);if(8295!=c){var d=e[r[l]];r[l]="⁧"+r[l],e[r[l]]=d,this.$TextField[2067]+=1}l>0&&(l-=1),o=0,r[l]=r[l]+"\n"}t=r.join(" "),t=t.replace(/\n /g,"\n")}return t},Object.defineProperty(egret.TextField.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0,null==t&&(t=[{text:""}]),this.textArr=t,this.$setText(t[0].text)},enumerable:!0,configurable:!0}),egret.TextField.prototype.$setWordWrap=function(t){var e=this.$TextField;e[998]||(e[998]=!0),t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField(),egret.nativeRender&&this.$nativeDisplayObject.setWordWrap(t)))},eui.sys.overideHTouchScroll()}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},LoadingBaseItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinComplete=!1,e._initFinish=!1,e.destory=!1,e.currStates="",e.preSelected=!1,e.once(egret.Event.COMPLETE,e.__skinCompleteHandler,e),e}return __extends(e,t),e.prototype.__skinCompleteHandler=function(t){this.skinComplete=!0,this.init()},e.prototype.init=function(){if(this.skinComplete){if(this._initFinish=!0,this.destory)return void this.dispose();this.initView(),this.initEvent(),this.initData()}},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.initData=function(){},Object.defineProperty(e.prototype,"initFinish",{get:function(){return this._initFinish},enumerable:!0,configurable:!0}),e.prototype.invalidateState=function(){t.prototype.invalidateState.call(this),this.currStates=this.getCurrentState(),("up"==this.currStates||"upAndSelected"==this.currStates)&&this.selected!=this.preSelected&&(this.preSelected=this.selected,this.selectedChange())},e.prototype.selectedChange=function(){},e.prototype.dispose=function(){this.destory=!0,this.removeEventListener(egret.Event.COMPLETE,this.__skinCompleteHandler,this),this.parent&&this.parent.removeChild(this)},e}(eui.ItemRenderer);__reflect(LoadingBaseItemRenderer.prototype,"LoadingBaseItemRenderer");var LoadingBaseUI=function(t){function e(e){var i=t.call(this)||this;return i.skinComplete=!1,i._initFinish=!1,i._destory=!1,i._id=e,i.__skinCompleteHandler(null),i}return __extends(e,t),e.prototype.__skinCompleteHandler=function(t){this.skinComplete=!0,this.init()},e.prototype.init=function(){if(this.skinComplete){if(this._initFinish=!0,this._destory)return void this.dispose();this.initView(),this.initEvent(),this.initData()}},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.initData=function(){},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initFinish",{get:function(){return this._initFinish},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destory",{get:function(){return this._destory},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._destory=!0,this.parent&&this.parent.removeChild(this)},e}(eui.Component);__reflect(LoadingBaseUI.prototype,"LoadingBaseUI");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoginRecent=function(){function t(){this.destory=!1}return t.prototype.start=function(){QQMiniShare.instance,LoadingFrame.instance.totalProg=50,LoadingConst.DEBUG?this.loginCallBack({data:htgPlatSdk.getAllURLParam()}):htgPlatSdk.loginGame(this.loginCallBack,this)},t.prototype.loginCallBack=function(t){t&&(t&&t.data&&t.data.textureFormats&&(LoadingConst.nativeSupportFormats=[].concat(t.data.textureFormats),delete t.data.textureFormats),LoginBackView.instance.initLoadBack(),LoadingLayer.instance.addChildAt(LoginBackView.instance,0),LoadingConst.canPlayVideo=!!t.data.isPlay,LoadingConst.IS_MINI_GAME&&htgPlatSdk.getUrlParam(UrlParamKey.RE_OPENID)?(new ChangeOpenIdView).show(t,this.requestRecentData.bind(this)):this.requestRecentData(t))},t.prototype.requestRecentData=function(t){var e=this;try{LoadingConst.snUserInfoJson=JSON.parse(t.data.snUserInfoJson||"{}")||{}}catch(i){LoadingConst.snUserInfoJson={}}try{var n=htgPlatSdk.getSysPlatform()||egret.Capabilities.os||"";LoadingConst.SYS_OS=n.toLowerCase(),console.log("当前系统:"+LoadingConst.SYS_OS),LoadingConst.SN_OPENID=t.data.snOpenId||"dev";var r=LoadingConst.getRecentUrl(t.data);this.reqTime_recent=egret.getTimer(),this.request=new egret.HttpRequest,this.request.open(r,egret.HttpMethod.GET),this.request.addEventListener(egret.Event.COMPLETE,this.__onGetCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__onGetIOErrorHandler,this),this.request.send(),setTimeout(function(){e.resTime_recent||LoadingManager.instance.errReport(2,"超时")},5e3)}catch(s){LoadingAlert.show("طلب خطأ في البيانات!",void 0,LoadingAlert.YES),LoadingManager.instance.errReport(2,null)}},t.prototype.__onGetCompleteHandler=function(t){var e=this;this.resTime_recent=egret.getTimer();try{var i=JSON.parse(this.request.response),n=i.c||0;if(1==n&&i.s){if(this.responseData=i,LoadingManager.instance.loginData=i,LoadingManager.instance.openId=this.responseData.openid,LoadingManager.instance.name=i.name,LoadingManager.instance.SERVER_MAX_ID=this.responseData.ct||1,LoadingConst.SVR_CONFIG=i.config||{},LoadingConst.SVR_CONFIG&&void 0==LoadingConst.SVR_CONFIG.closeAllAstc&&(LoadingConst.SVR_CONFIG.closeAllAstc="0"),KTXSupport.setup(!!+LoadingConst.SVR_CONFIG.closeAllAstc),this.request.removeEventListener(egret.Event.COMPLETE,this.__onGetCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onGetIOErrorHandler,this),this.serverData=this.responseData.s[0],!this.serverData)return void LoadingAlert.show(LoadingManager.instance.getMsgPrompt(1006),void 0,LoadingAlert.YES);this.responseData.s&&this.responseData.s.length||LoadingManager.instance.errReport(2),ResReplaceMgr.instance.init(function(){e.responseData.s.length>1||!e.serverData.isnew||1==e.responseData.s.length&&0==e.serverData.s||e.serverData.isnew&&2==e.serverData.s?e.loadServerFrame():e.startGame()},this)}else LoadingAlert.show(LoadingManager.instance.getMsgPrompt(1006),void 0,LoadingAlert.YES),LoadingManager.instance.errReport(2)}catch(t){LoadingAlert.show("طلب خطأ في البيانات!",void 0,LoadingAlert.YES),LoadingManager.instance.errReport(2,null)}},t.prototype.loadServerFrame=function(){LoginBackView.instance.show(1),LoadingFrame.instance.totalProg=100,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupCompletHandler,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupCompletHandler,this),RES.loadGroup(LoadingConst.SELECTSERVER)},t.prototype.__groupCompletHandler=function(t){t.groupName==LoadingConst.SELECTSERVER&&(PreLoadManager.instance.setup(),setTimeout(this.showServerFrame.bind(this),200))},t.prototype.showServerFrame=function(){if(!this.destory){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupCompletHandler,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupCompletHandler,this);var t=new SelectServerFrame;t.show(),LoadingFrame.instance.pause(),this.dispose()}},t.prototype.__onGetIOErrorHandler=function(t){LoadingAlert.show("فشل طلب سيرفر التاريجي!",void 0,LoadingAlert.YES),this.resTime_recent=egret.getTimer(),LoadingManager.instance.errReport(2,"请求失败")},t.prototype.startGame=function(){if(!this.serverData)return void LoadingAlert.show("يرجى تحديد سيرفر المنطقة!");if(2==this.serverData.s&&!LoadingConst.DEBUG)return void LoadingAlert.show(LoadingManager.instance.getMsgPrompt(8));if(!LoadingManager.instance.openId)return void LoadingAlert.show("openId فارغ!");LoadingManager.instance.serverData=this.serverData;var t=LoadingManager.instance.openId,e=this.serverData.id,i=LoadingManager.instance.serverData.an,n=LoadingManager.instance.serverData.aid;htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:100}),LoadingManager.instance.gameReport(100);var r=LoadingConst.getUIDUrl(e,t,i,n);this.reqTime_uid=egret.getTimer(),this.request.open(r,egret.HttpMethod.GET),this.request.addEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this),this.request.send();var s=this;setTimeout(function(){s.resTime_uid||LoadingManager.instance.errReport(3,"超时")},5e3)},t.prototype.__getUidCompleteHandler=function(t){this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this);var e=JSON.parse(this.request.response);if(this.resTime_uid=egret.getTimer(),e){var i=e.c||0;e.time||0;if(1==i)LoadingManager.instance.uid=parseInt(e.u),LoadingManager.instance.newbie=e.newbie,LoadingManager.instance.loginKey=e.k,LoadingManager.instance.chatKey=e.chatkey,LoadingManager.instance.ip=e.cip,LoadingManager.instance.port=e.cpt,e.wacts&&(LoadingManager.instance.wacts=e.wacts),LoadingManager.instance.enterGame();else{if(7!=i)return void LoadingAlert.show(LoadingManager.instance.getMsgPrompt(i),void 0,LoadingAlert.YES);LoadingManager.instance.enterSelectRole(void 0,void 0,void 0)}this.dispose()}},t.prototype.__getUidErrorHandler=function(t){this.destory||(this.resTime_uid=egret.getTimer(),this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this),LoadingAlert.show("فشل في الحصول على معلومات المستخدم!",void 0,LoadingAlert.YES),LoadingManager.instance.errReport(3,"获取失败"))},t.prototype.dispose=function(){this.destory||(this.destory=!0,this.request&&(this.request.removeEventListener(egret.Event.COMPLETE,this.__onGetCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onGetIOErrorHandler,this),this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this)),this.request=null,this.responseData=null,this.serverData=null,this.request=null)},t}();__reflect(LoginRecent.prototype,"LoginRecent");var SkipCreateRole=function(){function t(){}return t.prototype.step=function(t,e,i){this.callback=t,this.updateState=e,this.thisobj=i,this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.initEvent(),this.__regNickName(),setTimeout(function(){PreLoadManager.instance.setup()},10)},t.prototype.initEvent=function(){this.request.addEventListener(egret.Event.COMPLETE,this.__onCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__onIOErrorHandler,this)},t.prototype.removeEvent=function(){this.request.removeEventListener(egret.Event.COMPLETE,this.__onCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onIOErrorHandler,this)},t.prototype.__regNickName=function(){var t,e=LoadingManager.instance.serverData.id,i=LoadingManager.instance.openId,n=Math.ceil(2*Math.random()),r="",s=LoadingManager.instance.loginData.s;t=LoadingConst.IS_IOS_NATIVE?LoadingManager.instance.serverData.an:encodeURI(LoadingManager.instance.serverData.an);var o=LoadingManager.instance.serverData.aid,a=s&&s.length>1?"1":"0",h=LoadingConst.getCreatRoleUrl(e,i,n,r,LoadingConst.ZONE_KEY,a,t,o),l=QQMiniShare.instance.shareOpenID,c=QQMiniShare.instance.shareUID;l!=i&&QQMiniShare.instance.checkSign()&&(h+="&shareUID="+c,console.log("绑定分享人信息：shareUID:",c,"shareOpenID:",l)),this.request.open(h,egret.HttpMethod.GET),this.request.send()},t.prototype.__onCompleteHandler=function(){var t=JSON.parse(this.request.response);if(t){var e=t.c||0;t.time||0;if(1!=e)this.updateMsg(e);else{LoadingFrame.instance.setup(),LoadingManager.instance.uid=parseInt(t.u),LoadingManager.instance.loginKey=t.k,LoadingManager.instance.chatKey=t.chatkey,LoadingManager.instance.ip=t.cip,LoadingManager.instance.port=t.cpt,t.wacts&&(LoadingManager.instance.wacts=t.wacts),LoadingManager.instance.isNew=!0,LoginBackView.instance.show(1),LoadingManager.instance.enterGame();var i=t.reportdata;i&&(htgPlatSdk.gameReport(LoadingConst.REGISTER_REPORT,i),htgPlatSdk.gameReport(LoadingConst.CREATE_REPORT,i)),this.dispose()}}},t.prototype.__onIOErrorHandler=function(t){this.updateMsg(5)},t.prototype.updateMsg=function(t){void 0===t&&(t=1e3),LoadingAlert.show(LoadingManager.instance.getMsgPrompt(t),void 0,LoadingAlert.YES),"function"==typeof this.updateState&&this.updateState.call(this.thisobj)},t.prototype.dispose=function(){this.removeEvent(),"function"==typeof this.callback&&this.callback.call(this.thisobj),this.request=null},t}();__reflect(SkipCreateRole.prototype,"SkipCreateRole");var SmallLoading=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.__onAddToStageHandler,e),e}return __extends(e,t),e.prototype.__onAddToStageHandler=function(t){egretOverride(),egret.HtmlTextParser=HtmlTextParserArab,eui.Label=LabelArab,eui.EditableText=EditableLabelArab,eui.Scroller=SrollerArab,this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.__onAddToStageHandler,this),egret.ImageLoader.crossOrigin="anonymous",egret.TextField.default_fontFamily="SimHei",egret.TextField.default_textColor=16380887,egret.TextField.default_size=17,egret.TextField.defaultTouchEnabled=!1,LoadingConst.MINI_GAME_NAME=htgPlatSdk.miniGameName(),LoadingConst.IS_MOBILE=egret.Capabilities.isMobile,LoadingConst.ENT_TYPE=htgPlatSdk.entType(),this.initUrlParams(),LoadingConst.IS_MOBILE?(this.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW,this.stage.orientation=egret.OrientationMode.PORTRAIT,this.stage.frameRate=LoadingConst.MOBILE_FRAME_RATE):(egret.DisplayObject.prototype.hitalk$setX=egret.DisplayObject.prototype.$setX,egret.DisplayObject.prototype.hitalk$setY=egret.DisplayObject.prototype.$setY,egret.DisplayObject.prototype.$setX=function(t){return this.exact?this.hitalk$setX(t):this.hitalk$setX(~~t)},egret.DisplayObject.prototype.$setY=function(t){return this.exact?this.hitalk$setY(t):this.hitalk$setY(~~t)},this.stage.stageHeight<=940?this.stage.scaleMode=egret.StageScaleMode.FIXED_NARROW:this.stage.scaleMode=egret.StageScaleMode.NO_SCALE,this.stage.orientation=egret.OrientationMode.AUTO),LoadingConst.IS_MINI_GAME?htgPlatSdk.miniGameInit(this.__startLoader.bind(this)):LoadingConst.IS_IOS_NATIVE?htgPlatSdk.nativeGameInit(function(){LoadingConst.isIosNativeDebug()?htgPlatSdk.getMimeData(function(t){t&&(NativeUrlController.versionInfo=t,RES.VersionController=NativeUrlController),this.__startLoader()},this):this.__startLoader()}.bind(this)):this.__startLoader()},e.prototype.initJsonProcessor=function(){var t=new LegacyResConfigProcessor;RES.processor.map("legacyResourceConfig",t);var e=LoadingConst.isIosNativeDebug(),i=new HtgJsonProcessor(e);RES.processor.map("json",i)},e.prototype.__startLoader=function(){this.initJsonProcessor(),egret.registerImplementation("eui.IAssetAdapter",new AssetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),LoadingLayer.instance.init(this.stage),LoadingManager.$stage=this.stage,(LoadingConst.IS_MINI_GAME||LoadingConst.IS_IOS_NATIVE)&&(LoadingConst.res_path=htgPlatSdk.getResPath()+"resource/"),LoadingConst.SN_KEY&&(LoginBackView.instance.initLoadBack(),LoadingLayer.instance.addChildAt(LoginBackView.instance,0)),this.__startLoadResource()},e.prototype.__startLoadResource=function(){this.initUrlParams(),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.__onConfigComplete,this);var t="loading.res"+htgPlatSdk.getWebVer()+".json";RES.loadConfig(t,LoadingConst.res_path)},e.prototype.__onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.__onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupLoadErrHandler,this),RES.loadGroup(LoadingConst.LOADING_GROUP)},e.prototype.__groupLoadComplete=function(t){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupLoadErrHandler,this),htgPlatSdk.hideLoadingDiv(),htgPlatSdk.registerMsgPanel(LoadingAlert.show,LoadingAlert),LoadingFrame.instance.setup(),LoginBackView.instance.show(3),(new LoginRecent).start(),this.dispose()},e.prototype.initUrlParams=function(){LoadingConst.DEBUG="1"==htgPlatSdk.getUrlParam(UrlParamKey.DEBUG),LoadingConst.ZONE_KEY=htgPlatSdk.getUrlParam(UrlParamKey.ZONE_KEY),LoadingConst.SN_KEY=htgPlatSdk.getUrlParam(UrlParamKey.SN_KEY),LoadingConst.ISHTTPS=htgPlatSdk.isHttps()},e.prototype.__groupLoadErrHandler=function(t){LoadingFrame.instance.msgTxt.text=LoadingConst.MSG_2},e.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},e}(egret.DisplayObjectContainer);__reflect(SmallLoading.prototype,"SmallLoading");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)this.loadEuiJson(e,n);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t.prototype.loadEuiJson=function(t,e){var i=this,n="euifiles"+htgPlatSdk.getWebVer()+".json",r=LoadingConst.res_path+n;this.loadRes(r).then(function(n){for(var r,s=[],o=n&&n.length||0,a=0;o>a;a++)r=i.loadRes(LoadingConst.res_path+n[a]),s.push(r);s.length>0&&Promise.all(s).then(function(n){for(var r=n&&n.length||0,s=0;r>s;s++)window.JSONParseClass.setData(n[s]);egret.callLater(function(){t.call(e,generateEUI2)},i)},function(t){console.log("加载euiData失败！")})},function(t){console.log("加载错误！")})},t.prototype.loadRes=function(t){var e=this;return new Promise(function(i,n){RES.getResByUrl(t,function(t,e){t&&t.length||0;t?i(t):n(null)},e,RES.ResourceItem.TYPE_JSON)})},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var EntType=function(){function t(){}return t.web="web",t.native_ios="native_ios",t.native_android="native_android",t.android_mini="android_mini",t.mini="minigame",t}();__reflect(EntType.prototype,"EntType");var EventReportType;!function(t){t.create_role_success="create_role_success",t.video_finish="video_finish",t.minigame_finish="minigame_finish",t.defeatdragon_finish="defeatdragon_finish",t.firstmap_start="firstmap_start",t.stage_finish="stage{}_finish"}(EventReportType||(EventReportType={}));var LoadingConst=function(){function t(){}return t.isReplaceResSn=function(){return null},t.isReplaceResThemeActivity=function(){return t.SVR_CONFIG.thmActRes},t.disposeObject=function(t){t&&(t.parent&&t.parent.removeChild(t),t.dispose&&t.dispose())},t.getStringLength=function(t){if(!t||0==t.length)return 0;for(var e,i=0,n=/[\x00-\xff]/,r=0;r<t.length;r++)e=t.charAt(r),i+=n.test(e)?1:2;return i},t.getClickSound=function(){return t.res_path+"sounds/click_1.mp3"},t.getClickSounds=function(){return t.res_path+"sounds/click_2.mp3"},t.getClickSound3=function(){return t.res_path+"sounds/click_3.mp3"},t.httpHead=function(){return t.ISHTTPS?"https://":"http://"},t.getServerAdd=function(){if(!this.loginServer){var e=htgPlatSdk.getLoginServer();e.indexOf("http")<0&&(e=t.httpHead()+e),this.loginServer=e+"/client/"}return this.loginServer},t.getRecentUrl=function(e){e=e||{},"1"==e.is_native&&(this.deviceInfo={},this.deviceInfo.is_native=e.is_native,this.deviceInfo.nat_device=e.nat_device,this.deviceInfo.dev_model=e.dev_model,this.deviceInfo.dev_sdk=e.dev_sdk,this.deviceInfo.dev_version=e.dev_version,this.deviceInfo.dev_firm=e.dev_firm),!e[UrlParamKey.ZONE_KEY]&&(e[UrlParamKey.ZONE_KEY]=t.ZONE_KEY),!e[UrlParamKey.SN_KEY]&&(e[UrlParamKey.SN_KEY]=t.SN_KEY);var i=this.getServerAdd()+"recent?"+t.formatUrlParam(e);return i},t.getUIDUrl=function(e,i,n,r){var s={};if(s.openId=i,s.id=e,s.an=n,s.aid=r,t.SN_KEY&&(s.snKey=t.SN_KEY),s.check=t.checkState,t.SN_OPENID&&(s.snopenid=t.SN_OPENID),this.deviceInfo)for(var o in this.deviceInfo)s[o]=this.deviceInfo[o];s.tskey=htgPlatSdk.getUrlParam("tsKey"),t.snUserInfoJson.gamePackageId&&(s.gamePackageId=t.snUserInfoJson.gamePackageId);var a=this.getServerAdd()+"uid?"+t.formatUrlParam(s);return a},t.getCreatRoleUrl=function(e,i,n,r,s,o,a,h){var l={};if(l.openId=i,l.id=e,l.sex=n,l.name=r,l.gunfu=o,l.an=a,l.aid=h,l.snKey=t.SN_KEY,l.check=t.checkState,t.SN_OPENID&&(l.snopenid=t.SN_OPENID),this.deviceInfo)for(var c in this.deviceInfo)l[c]=this.deviceInfo[c];l.tskey=htgPlatSdk.getUrlParam("tsKey"),l.zoneKey=s,t.snUserInfoJson.gamePackageId&&(l.gamePackageId=t.snUserInfoJson.gamePackageId);var d=this.getServerAdd()+"name?"+t.formatUrlParam(l);return d},t.getAllServerListUrl=function(e,i){var n={};n.openId=e,n.zoneKey=i;var r=t.formatUrlParam(n);return r=this.getServerAdd()+"all?"+r},t.formatUrlParam=function(e){e=e||{};var i=[];if(t.IS_IOS_NATIVE)for(var n in e)i.push(n+"="+e[n]);else for(var n in e)i.push(n+"="+encodeURIComponent(e[n]));return!e.os&&i.push("os="+t.SYS_OS),!e.isHttps&&t.ISHTTPS&&i.push("isHttps="+t.ISHTTPS),!e.debug&&t.DEBUG&&i.push("debug=1"),!e.htgran&&i.push("htgran="+Math.random()),i.join("&")},Object.defineProperty(t,"IS_MINI_GAME",{get:function(){return!!t.MINI_GAME_NAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_QQ_MINI",{get:function(){return"qqgame"==t.MINI_GAME_NAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_WX_MINI",{get:function(){return"wxgame"==t.MINI_GAME_NAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_IOS_NATIVE",{get:function(){return t.ENT_TYPE==EntType.native_ios},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_ANDROID_NATIVE",{get:function(){return t.ENT_TYPE==EntType.native_android||t.ENT_TYPE==EntType.android_mini},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_NATIVE",{get:function(){return this.IS_IOS_NATIVE||this.IS_ANDROID_NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"useLocalTemp",{get:function(){return window.USE_LOCAL_TEMP},enumerable:!0,configurable:!0}),t.iosHideProgress=function(){if(!this.IS_IOS_NATIVE)return!1;var t=htgPlatSdk.getUrlParam(UrlParamKey.IS_RELEASE);return!+t},t.isIosNativeRelease=function(){if(!this.IS_IOS_NATIVE)return!1;var t=htgPlatSdk.getUrlParam(UrlParamKey.IS_RELEASE);return!!+t},t.isIosNativeDebug=function(){if(!this.IS_IOS_NATIVE)return!1;var t=htgPlatSdk.getUrlParam(UrlParamKey.IS_RELEASE);return!+t},Object.defineProperty(t,"IS_WANBA",{get:function(){return!1},enumerable:!0,configurable:!0}),t.parserHtml=function(t){return t?(!this.htmlParsr&&(this.htmlParsr=new egret.HtmlTextParser),this.htmlParsr.parser(t)):[]},t.getHtmlFlow=function(e){if(!e)return null;var i;try{i=t.parserHtml(e)}catch(n){e=e||"",e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),i=t.parserHtml(e)}var r=[i[0]];if(i.length>1)for(var s=1;s<i.length;s++)r[0].text+=i[s].text;return r[0].style=void 0,r},Object.defineProperty(t,"IS_XIN_YUE",{get:function(){return t.SN_KEY==PlatformSnKey.h0108},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_MOBILE_QQ",{get:function(){return t.SN_KEY==PlatformSnKey.h0035},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_TX_VIDEO",{get:function(){return t.SN_KEY==PlatformSnKey.h10086},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_WYXX",{get:function(){return t.SN_KEY==PlatformSnKey.h0213},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_WXGK",{get:function(){return t.SN_KEY==PlatformSnKey.h0226},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_AIWEIYOU",{get:function(){return t.SN_KEY==PlatformSnKey.h0240},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_FENGKUANG",{get:function(){return t.SN_KEY==PlatformSnKey.h0123||t.SN_KEY==PlatformSnKey.h0213},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IS_DHDL",{get:function(){return t.SN_KEY==PlatformSnKey.h0304},enumerable:!0,configurable:!0}),Object.defineProperty(t,"checkState",{get:function(){var t=htgPlatSdk.searchExtraAction("contentCheck"),e=t&&t.status?0:1;return e},enumerable:!0,configurable:!0}),t.DEBUG=!1,t.REGISTER_REPORT=1,t.CREATE_REPORT=2,t.LOGIN_REPORT=3,t.UPGRADE_REPORT=4,t.VIP_REPORT=5,t.POINT_REPORT=6,t.TEXTURE_COMPRESSED=0,t.support_texture=0,t.nativeSupportFormats=[],t.res_path="resource/",t.ISHTTPS=!1,t.IS_REPORT_SELECT_SER=!1,t.MINI_GAME_NAME="",t.QQ_MINI_RELEASE=!1,t.SYS_OS="",t.IS_MOBILE=!1,t.MOBILE_FRAME_RATE=60,t.IS_APP=!0,t.PC_FRAME_RATE=60,t.ZONE_KEY="",t.SN_OPENID="",t.TS_KEY="",t.SN_KEY="",t.SVR_CONFIG={},t.SELECTSERVER="SelectServerFrame",t.SELECTROLE="SelectRoleFrame",t.LOADING_BACK_URL="loading/loading_back",t.LOADING_BACK_PC="loading/loading_back_pc",t.LOADING_BACK_URL_WYXX="loading/loading_back_wyxx",t.LOADING_BACK_PC_WYXX="loading/loading_back_pc.jpg",t.BONES_PLATE="bones/plate_",t.BONES_MAN="bones/selectrole_1",t.BONES_WOMAN="bones/selectrole_2",t.BONES_SERVER="bones/selectserver",t.LOADING_GROUP="LoadingFrame",t.MSG_1="التحميل الأولي يستغرق وقتاً طويلاً، يرجى الانتظار...",t.MSG_2="خطأ في تحميل مجموعة الموارد!!! يرجى التحقق من الشبكة",t.MSG_5="إذا لم يمكنك الدخول إلى اللعبة،<font color='#25f542'><u><a href='event:text'> يرجى النقر للتحديث </a></u></font> (جاري التشغيل {}%)",t.preload="preload",t.VERSION="1.0.1.",t.SELECT_SERVER_TIP="جاري طلب السيرفر...",t.HISTORY_SERVER="سيرفر المحفوظات",t.SERVER="سيرفر",t.GET_ERROR="فشل في الحصول على قائمة سيرفر المنطقة!",t.ENTER_GAME=["تم استلام <font color='0xff0000'> سيف التمثال. قتل الروح</font>","ترقية ناجحة ","استلمت حزمة 8888 قلادة اليشم"],t.NAME_FRONT=["أحد","أحمد","أحمر","أدهم","أديب","أسلم","أكرم","أمير","أيوب","إياد","الحلي","الصدر","بارقي","بدر","بدوي"," بشار","بشير","بطرس","بلال","توفيق","جابر","جبران"],t.NAME_BOY=["آصف","أبان","أبسل","أبلج","أجيد","أحد","أحمد","أحنف","أحوس","أخزم","أخضر","أخطب","أدعج","أدغم","أدهم","أديب","أرغد","أرقم","أريب","أريز","أزهر","أزور","أسامة","أسد","أسعد","أسلم","أسمر","أشتر"],t.NAME_GIRL=["آلاء","آمال","آمنة","آيات","آية","آيلا","أبرار","أثيل","أجوان","أحلام","أروى","أريج","أزهار","أسماء","أسمى","أسيل","أشجان","أطياف","أفراح","أفكار","أفنان","ألطاف","ألوف","أمارة","أمال","أمامة","أمانة","أماني"],t.MSG_3="قائمة السيرفر غير متاحة حالياً",t.MSG_4=" حدد السيرفر",t.MSG_6="ستدخل العالم الجديد تلقائيا بعد {} ثوان",t.MSG_7="",t.MSG_8=" إشعار",t.MSG_9="لقد قرأته بالتفصيل وأوافق",t.MSG_10="اتفاقية المستخدم",t.MSG_11=" سياسة الخصوصية",t.MSG_12=" يرجى قراءة اتفاقية المستخدم وسياسة الخصوصية أولاً ",t.MSG_13="هل أنت متأكد؟",t.PUBLISHING_INFO_TEXT="",t.PUBLISHING_INFO_TEXT_3="",t.PUBLISHING_INFO_TEXT_4="",t.PUBLISHING_INFO_TEXT_5="",t.PUBLISHING_INFO_TEXT_6="",t.PUBLISHING_INFO_TEXT_7="",t.PUBLISHING_INFO_WYXX="",t.PUBLISHING_INFO_DHDL="",t.CLEAN_CACHE=" مسح ذاكرة التخزين المؤقت ",t.AGREEMENT_KEY="userAgreement",t.AGE_TIPS="",t.AGR_TIPS_TITLE="نصائح",t.GAME_PACT="",t.MSG_14="",t.PUBLISHING_INFO_TEXT_1="",t.PUBLISHING_INFO_TEXT_2="",t.snUserInfoJson={},t}();__reflect(LoadingConst.prototype,"LoadingConst");var PlatformSnKey=function(){function t(){}return t.changeLoginBack=function(e){switch(e){case t.h0162:case t.h0080:return 3;case t.h0213:case t.h0226:case t.h0240:return 4;case t.h0200:return 5;case t.hw089:return 6}var i=+htgPlatSdk.getUrlParam(UrlParamKey.HITALKBAG);return i},t.isGaore=function(){return this.isGaore_4()||this.isGaore_5()||this.isGaore_6()||this.isGaore_7()||this.isGaore_8()||this.isGaore_9()||this.isGaore_10()||this.isGaore_11()||this.isGaore_12()||this.isGaore_13()||this.isGaore_14()||this.isGaore_15()||this.isGaore_16()||this.isGaore_17()||this.isGaore_18()||this.isGaore_19()||this.isGaore_20()},t.isGaore_4=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_4},t.isGaore_5=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_5},t.isGaore_6=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_6},t.isGaore_7=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_7},t.isGaore_8=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_8},t.isGaore_9=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_9},t.isGaore_10=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_10},t.isGaore_11=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_11},t.isGaore_12=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_12},t.isGaore_13=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_13
},t.isGaore_14=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_14},t.isGaore_15=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_15},t.isGaore_16=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_16},t.isGaore_17=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_17},t.isGaore_18=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_18},t.isGaore_19=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_19},t.isGaore_20=function(){return LoadingConst.ZONE_KEY==PlatformZoneKey.gaore_20},t.isFzml=function(e){switch(e){case t.h0200:return!0}return!1},t.isGanke=function(e){switch(e){case t.h0226:return!0}return!1},t.isAwy=function(e){switch(e){case t.h0240:return!0}return!1},t.isGaoReIosNative=function(){return LoadingConst.IS_IOS_NATIVE&&this.isGaore()},t.h0210="h0210",t.h0091="h0091",t.h0216="h0216",t.h0162="h0162",t.h0080="h0080",t.h0108="h0108",t.h0035="h0035",t.h10086="h10086",t.h0123="h0123",t.h0213="h0213",t.h0200="h0200",t.h0226="h0226",t.h0240="h0240",t.h0234="h0234",t.h0235="h0235",t.h0236="h0236",t.h0237="h0237",t.h0304="h0304",t.hw089="hw089",t}();__reflect(PlatformSnKey.prototype,"PlatformSnKey");var PlatformZoneKey=function(){function t(){}return t.gaore_4="frx_gr_4",t.gaore_5="frx_gr_5",t.gaore_6="frx_gr_6",t.gaore_7="frx_gr_7",t.gaore_8="frx_gr_8",t.gaore_9="frx_gr_9",t.gaore_10="frx_gr_10",t.gaore_11="frx_gr_11",t.gaore_12="frx_gr_12",t.gaore_13="frx_gr_13",t.gaore_14="frx_gr_14",t.gaore_15="frx_gr_15",t.gaore_16="frx_gr_16",t.gaore_17="frx_gr_17",t.gaore_18="frx_gr_18",t.gaore_19="frx_gr_19",t.gaore_20="frx_gr_20",t}();__reflect(PlatformZoneKey.prototype,"PlatformZoneKey");var ProcessorType=function(){function t(){}return t.KTX="ktx",t.ETC1_KTX="etc1.ktx",t.ASTC_4_KTX="astc4.ktx",t.ASTC_8_KTX="astc8.ktx",t}();__reflect(ProcessorType.prototype,"ProcessorType");var TextureCompressType;!function(t){t[t.etc1=1]="etc1",t[t.pvrtc=2]="pvrtc",t[t.astc4=4]="astc4",t[t.astc8=8]="astc8"}(TextureCompressType||(TextureCompressType={})),window.TextureCompressType=TextureCompressType;var UrlParamKey=function(){function t(){}return t.OPENID="openId",t.RE_OPENID="reOpenId",t.SN_KEY="snKey",t.ZONE_KEY="zoneKey",t.SN_OPENID="snOpenId",t.DEBUG="debug",t.SHAREUID="shareUID",t.SHAREOPENID="shareOpenID",t.SHARETIME="shareTime",t.SHARESIGN="shareSign",t.IS_RELEASE="release",t.HITALKBAG="hitalkBag",t}();__reflect(UrlParamKey.prototype,"UrlParamKey"),window.UrlParamKey=UrlParamKey;var KTXSupport=function(){function t(){}return t.setup=function(t){this.isSetup||(this.isSetup=!0,this.closeAllAstc=!!t,console.log("current renderMode is：",egret.Capabilities.renderMode),"webgl"==egret.Capabilities.renderMode&&(this.getSupportTexture(),this.getNativeSupportTexture(),this.supportNativeKtx(),this.initTextureCompress(),+LoadingConst.SVR_CONFIG.closeEuiAstc||!this.hasTextureCompressType(TextureCompressType.astc4)&&!this.hasTextureCompressType(TextureCompressType.astc8)||RES.processor.map("sheet",new SheetASTCProcessor),RES.processor.map("astc4.ktx",RES.processor.KTXTextureProcessor),RES.processor.map("astc8.ktx",RES.processor.KTXTextureProcessor),console.log("开启纹理格式:",this.supportTypes.join("、"))))},t.initTextureCompress=function(){LoadingConst.IS_IOS_NATIVE||LoadingConst.IS_QQ_MINI||(LoadingConst.TEXTURE_COMPRESSED=LoadingConst.support_texture,this.hasTextureCompressType(TextureCompressType.astc8)&&this.supportTypes.push("astc_8x8"),this.hasTextureCompressType(TextureCompressType.astc4)&&this.supportTypes.push("astc_4x4"))},t.getSupportTexture=function(){var t,e=egret.wxgame||egret.qqgame||egret.web,i=e&&e.WebGLRenderContext;if(i&&(t=i.getInstance()),t&&t.context){var n=t.context,r=this.getWebglExtension(n,"WEBGL_compressed_texture_etc1"),s=0;this.existCompressedType(r,36196)&&(console.log("支持etc1压缩纹理！"),s=1|s);var o=this.getWebglExtension(n,"WEBGL_compressed_texture_pvrtc");this.existCompressedType(o,35842)&&(console.log("支持pvrtc压缩纹理！"),s=2|s);var a=this.getWebglExtension(n,"WEBGL_compressed_texture_astc");!this.closeAllAstc&&this.existCompressedType(a,37808)&&(console.log("支持astc_4x4压缩纹理！"),s=4|s),!this.closeAllAstc&&this.existCompressedType(a,37815)&&(console.log("支持astc_8x8压缩纹理！"),s=8|s),!this.closeAllAstc&&this.existCompressedType(a,37812)&&(console.log("支持astc_6x6压缩纹理！"),s=16|s),LoadingConst.support_texture=s}},t.getNativeSupportTexture=function(){if(LoadingConst.IS_ANDROID_NATIVE){var t=LoadingConst.nativeSupportFormats,e=t&&t.length||0,i=0;if(e>0){var n=t.indexOf(37808);n>=0&&(console.log("支持astc_4x4压缩纹理！"),i=4|i),n=t.indexOf(37812),n>=0&&(console.log("支持astc_6x6压缩纹理！"),i=16|i),n=t.indexOf(37815),n>=0&&(console.log("支持astc_8x8压缩纹理！"),i=8|i)}LoadingConst.support_texture=i}},t.getWebglExtension=function(t,e){if(t){var i=t.getExtension(e)||t.getExtension("WEBKIT_"+e);return i}return null},t.existCompressedType=function(t,e){if(!t)return!1;for(var i in t)if(t[i]===e)return!0;return!1},t.hasTextureCompressType=function(t){return(LoadingConst.TEXTURE_COMPRESSED&t)>0},t.supportNativeKtx=function(){egret.BitmapData.prototype.$setCompressed2dTextureData=function(t){egret.nativeRender&&0==this.compressedTextureData.length&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,t[0]),this.compressedTextureData.push(t)},egret.KTXContainer.prototype._upload2DCompressedLevels=function(t,e){t.clearCompressedTextureData();for(var i=64+this.bytesOfKeyValueData,n=this.pixelWidth,r=this.pixelHeight,s=e?this.numberOfMipmapLevels:1,o=0;s>o;o++){var a=new Int32Array(this.arrayBuffer,i,1)[0];i+=4;for(var h=[],l=0;l<this.numberOfFaces;l++){var c=new Uint8Array(this.arrayBuffer,i,a),d=new egret.CompressedTextureData;d.glInternalFormat=this.glInternalFormat,d.width=n,d.height=r,d.byteArray=c,d.face=l,d.level=o,h.push(d),i+=a,i+=3-(a+3)%4}t.$setCompressed2dTextureData(h),n=Math.max(1,.5*n),r=Math.max(1,.5*r)}var g=t.getCompressed2dTextureData();g&&(t.width=g.width,t.height=g.height)}},t.supportTypes=[],t}();__reflect(KTXSupport.prototype,"KTXSupport"),window.KTXSupport=KTXSupport;var SheetASTCProcessor=function(){function t(){}return t.prototype.onLoadStart=function(t,e){var i=this;return t.load(e,"json").then(function(n){if(!n)return null;var r=RES.ResourceItem.TYPE_IMAGE;n.astc4?(n.file=i.getKtxFileName(n.file,".astc4.ktx"),r=ProcessorType.ASTC_4_KTX):n.astc8&&(n.file=i.getKtxFileName(n.file,".astc8.ktx"),r=ProcessorType.ASTC_8_KTX);var s=t.resourceConfig.getResource(RES.nameSelector(n.file));if(!s){var o=i.getRelativePath(e.url,n.file);s={name:RES.nameSelector(n.file),url:o,type:r,root:e.root},t.resourceConfig.addResourceData(s)}return t.load(s).then(function(e){if(!e)return null;var i=n.frames,r=new egret.SpriteSheet(e);r.$resourceInfo=s;for(var o in i){var a=i[o],h=r.createTexture(o,a.x,a.y,a.w,a.h,a.offX,a.offY,a.sourceW,a.sourceH);if(a.scale9grid){var l=a.scale9grid,c=l.split(",");h.scale9Grid=new egret.Rectangle(parseInt(c[0]),parseInt(c[1]),parseInt(c[2]),parseInt(c[3]))}}return t.save(s,e),r},function(e){throw t.remove(s),e})})},t.prototype.getKtxFileName=function(t,e){if(!t)return t;var i=t.indexOf(".");if(i>=0){var n=t.substring(0,i);t=n+e}return t},t.prototype.getData=function(t,e,i,n){var r=t.get(e);return r?r.getTexture(n):null},t.prototype.onRemoveStart=function(t,e){var i=t.get(e),n=i&&i.$resourceInfo;i&&i.dispose(),t.unload(n)},t.prototype.getRelativePath=function(t,e){if(-1!=e.indexOf("://"))return e;t=t.split("\\").join("/");var i=t.match(/#.*|\?.*/),n="";i&&(n=i[0]);var r=t.lastIndexOf("/");return t=-1!=r?t.substring(0,r+1)+e:e,t+n},t}();__reflect(SheetASTCProcessor.prototype,"SheetASTCProcessor",["RES.processor.Processor"]);var LoadingLayer=function(t){function e(){var i=this;if(!e._instance)return i=t.call(this)||this,e._instance=i,i}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.init=function(t){t&&(this._currStage=t,this.touchEnabled=!1,this._blackGoundList=[],this._currStage.addEventListener(egret.Event.RESIZE,this.__resizeHandler,this),this.scaleX=-1,this.x=this._currStage.stageWidth,this._currStage.addChild(this))},e.prototype.addToLayer=function(t,e){void 0===e&&(e=0),1==e&&(-1!=this._blackGoundList.indexOf(t)&&this._blackGoundList.splice(this._blackGoundList.indexOf(t),1),this._blackGoundList.push(t)),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__childRemoveedFromStageHandler,this),this.addChild(t),this.arrangeBlockGound()},e.prototype.__childRemoveedFromStageHandler=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__childRemoveedFromStageHandler,this),-1!=this._blackGoundList.indexOf(e)&&this._blackGoundList.splice(this._blackGoundList.indexOf(e),1),this.arrangeBlockGound()},e.prototype.__blackClickHandler=function(t){if(this._blackGoundList){var e=this._blackGoundList[this._blackGoundList.length-1];e&&"function"==typeof e.autoTouchClose&&e.autoTouchClose()&&LoadingConst.disposeObject(e)}},e.prototype.arrangeBlockGound=function(){this._blackGound&&this._blackGound.parent&&this._blackGound.parent.removeChild(this._blackGound);var t,e;this._blackGoundList.length>0&&(t=this._blackGoundList[this._blackGoundList.length-1],e=this.getChildIndex(t),this.addChildAt(this.blackGound,e))},Object.defineProperty(e.prototype,"blackGound",{get:function(){return this._blackGound||(this._blackGound=new egret.Sprite,this._blackGound.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__blackClickHandler,this),this._blackGound.touchEnabled=!0),(this._bgw!=this._currStage.stageWidth||this._bgh!=this._currStage.stageHeight)&&(this._bgw=this._currStage.stageWidth,this._bgh=this._currStage.stageHeight,this._blackGound.graphics.clear(),this._blackGound.graphics.beginFill(0,.6),this._blackGound.graphics.drawRect(0,0,this._bgw,this._bgh),this._blackGound.graphics.endFill()),this._blackGound},enumerable:!0,configurable:!0}),e.prototype.__resizeHandler=function(t){this.x=this._currStage.stageWidth,this._blackGound&&this._blackGound.parent&&this.blackGound},e.prototype.dispose=function(){for(var t=this.numChildren,i=0;t>i;i++)this.removeChild(this.getChildAt(0));this._blackGound&&this._blackGound.graphics.clear(),this._blackGound=null,this._blackGoundList=null,e._instance=null,this._currStage.removeEventListener(egret.Event.RESIZE,this.__resizeHandler,this),this._currStage=null,this.parent&&this.parent.removeChild(this)},e}(eui.UILayer);__reflect(LoadingLayer.prototype,"LoadingLayer");var LoadingManager=function(){function t(){t._instance||(t._instance=this)}return Object.defineProperty(t,"instance",{get:function(){return this._instance||new t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allTemplateData",{get:function(){return this._allTemplateData},set:function(t){if(t)if(this._allTemplateData)for(var e in t)this._allTemplateData[e]||(this._allTemplateData[e]={}),this.oto(t[e],this._allTemplateData[e]);else this._allTemplateData=t},enumerable:!0,configurable:!0}),t.prototype.oto=function(t,e){for(var i in t)e[i]=t[i]},t.prototype.getNickNameBySex=function(t){var e="";if(!this.fistName){var i=RES.getRes("nick_name_lib_json");i&&(this.fistName=i.fistName.split(","),this.manName=i.manName.split(","),this.womenName=i.womenName.split(","),this.manName2=i.manName2.split(","),this.womenName2=i.womenName2.split(","))}if(this.fistName&&this.fistName.length>0){var n=Math.floor(Math.random()*this.fistName.length);e+=this.fistName[n]+" ";var r=1==t?this.manName:this.womenName;n=Math.floor(Math.random()*r.length),e+=r[n],r=1==t?this.manName2:this.womenName2,n=Math.floor(Math.random()*r.length),e+=r[n]}return e},t.prototype.getMsgPrompt=function(t){switch(t){case 1:return"نجاح!";case 2:return"إنشاء الشخصية بشكل متكرر جداً!";case 3:return"اسم الشخصية موجود بالفعل!";case 5:case 8:return"السيرفر تحت الصيانة";case 6:case 11:return"تم حظره!";case 7:return"اللاعب لم ينشئ شخصية!";case 9:return"السيرفر لم يُفتح بعد!";case 12:return"السيرفر ممتلئ لذا يرجى الذهاب الى السيرفر الجديد لتجربته";case 1e3:return"";case 1001:return"اسم الشخصية فارغ!";case 4:case 1002:return"يحتوي اسم الشخصية على أحرف حساسة!";case 1003:return"اسم الشخصية قصير جداً!";case 1004:return"اسم الشخصية طويل جداً!";case 1005:return"تحتاج إلى الموافقة على اتفاقية المستخدم لبدء اللعبة";case 1006:return"لم يتم العثور على سيرفر المحفوظات!";default:return"خطأ داخلي في البارامتر أو السيرفر!"}},t.prototype.enterSelectRole=function(e,i,n){if(htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:101}),t.instance.gameReport(101),t.instance.loginData.pstatus){var r=new SkipCreateRole;r.step(e,i,n)}else e&&"function"==typeof e&&e.call(n),LoadingFrame.instance.setup(),LoadingFrame.instance.totalProg=100,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupLoadComplete,this),RES.loadGroup(LoadingConst.SELECTROLE)},t.prototype.__groupLoadComplete=function(t){t.groupName==LoadingConst.SELECTROLE&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.__groupLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.__groupLoadComplete,this),t.type==RES.ResourceEvent.GROUP_COMPLETE?setTimeout(this.__loadSelectRoleHandler.bind(this),200):LoadingAlert.show("加载资源出错!!!"+LoadingConst.SELECTROLE))},t.prototype.__loadSelectRoleHandler=function(){htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:11}),LoadingFrame.instance.pause(),LoginBackView.instance.show(2),(new SelectRoleFrame).show(),setTimeout(function(){PreLoadManager.instance.setup()},10)},t.prototype.enterGame=function(){PreLoadManager.instance.setup(),PreLoadManager.instance.enterGame(),LoadingFrame.instance.setup(),QQMiniShare.instance.uid=t.instance.uid,QQMiniShare.instance.openid=t.instance.openId;var e=[];e.push({type:2}),LoadingFrame.instance.load(e,this.__loadCompleteHandler,this),htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:16})},t.prototype.__loadCompleteHandler=function(){var t=egret.getDefinitionByName("LoginManager"),e=this;t&&t.instance.enterGame(this.allTemplateData,function(){LoadingFrame.instance.dispose(),LoginBackView.instance.dispose(),LoadingAlert.instance.dispose(),LoadingLayer.instance.dispose(),LoadingConst.NAME_BOY=null,LoadingConst.NAME_FRONT=null,LoadingConst.NAME_GIRL=null,LoadingConst.ENTER_GAME=null,htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:14}),e.dispose()})},t.prototype.gameReport=function(t){var e=this.uid||0,i=this.loginData.openid||0,n=this.serverData?this.serverData.an:"",r=this.serverData?this.serverData.id:0,s=window.location.protocol+"//"+(window.htgConfig?window.htgConfig.loginServer+"/report/hitalk":"")+"?ran = "+Math.random();s&&"function"==typeof htgPlatSdk.gameReport2&&htgPlatSdk.gameReport2(s,{type:t,uid:e,openid:i,aname:n,aid:r})},t.prototype.errReport=function(e,i){if(!t.destory){var n=window.location.protocol,r=window.location.origin,s=n+"//"+(window.htgConfig?window.htgConfig.errorReport:"")+"?ran = "+Math.random(),o=!1;if(r&&r.indexOf("cdn")>-1&&(o=!0,s=n+"//hitalk-hw-report.hhygame.com/client/report?ran = "+Math.random()),o||4!=e&&5!=e){var a=this.uid||0,h=this.loginData?this.loginData.openid:0,l=this.serverData?this.serverData.id:0,c={game:"上古传奇",zone_key:LoadingConst.ZONE_KEY,openid:h,sid:l,uid:a,type:e,data:i};htgPlatSdk.errorReport(s,c)}}},t.prototype.sentGetErrReport=function(e,i){if(!t.destory){var n=window.location.protocol,r=window.location.origin,s=n+"//"+(window.htgConfig?window.htgConfig.errorReport:"")+"?ran = "+Math.random(),o=!1;if(r&&r.indexOf("cdn")>-1&&(o=!0,s=n+"//hitalk-hw-report.hhygame.com/client/report"),o||4!=e&&5!=e){var a=this.uid||0,h=this.loginData?this.loginData.openid:0,l=this.serverData?this.serverData.id:0,c={game:"上古传奇",zone_key:LoadingConst.ZONE_KEY,openid:h,sid:l,uid:a,type:e,data:i},d=[];for(var g in c)d.push(g+"="+encodeURIComponent(c[g]));var u=d.join("&");s=s+"?"+u+"&ran = "+Math.random(),htgPlatSdk.sentGetErrorReport(s,c)}}},t.isEmojiCharacter=function(t){if(!t||0==t.length)return!1;for(var e=0;e<t.length;e++){var i=t.charCodeAt(e);if(i>=55296&&56319>=i){if(t.length>1){var n=t.charCodeAt(e+1),r=1024*(i-55296)+(n-56320)+65536;if(r>=118784&&128895>=r)return!0}}else if(t.length>1){var s=t.charCodeAt(e+1);if(8419===s)return!0}else{if(i>=8448&&10239>=i)return!0;if(i>=11013&&11015>=i)return!0;if(i>=10548&&10549>=i)return!0;if(i>=12951&&12953>=i)return!0;if(169===i||174===i||12349===i||12336===i||11093===i||11036===i||11035===i||11088===i)return!0}}return!1},t.formatDateBySec=function(t){var e="";if(t>0){this.dateObj.setTime(1e3*t);var i=this.formatSingle(this.dateObj.getMonth()+1),n=this.formatSingle(this.dateObj.getDate()),r=this.formatSingle(this.dateObj.getHours()),s=this.formatSingle(this.dateObj.getMinutes());this.formatSingle(this.dateObj.getSeconds());e+="Thời gian mở server: "+r+":"+s+" ngày "+n+"."+i+"."+this.dateObj.getFullYear()}return e},t.formatSingle=function(t){return 10>t?"0"+t:t.toString()},t.prototype.dispose=function(){this.openId=null,this.name=null,this.loginData=null,this.loginKey=null,this.chatKey=null,this.fistName&&(this.fistName.length=0),this.fistName=null,this.manName&&(this.manName.length=0),this.manName=null,this.womenName&&(this.womenName.length=0),this.womenName=null,this.uid=null,this.newbie=null,this.ip=null,this.port=null,this.serverData=null,this.isNew=null,this._allTemplateData=null,this.SERVER_MAX_ID=null,this.wacts=null,t.destory=!0,t._instance=null},t.hour_scc=3600,t.dateObj=new Date,t.day_sec=86400,t}();__reflect(LoadingManager.prototype,"LoadingManager");var PreLoadManager=function(){function t(){t._instance||(t._instance=this,this.init())}return Object.defineProperty(t,"instance",{get:function(){return this._instance||new t},enumerable:!0,configurable:!0}),t.prototype.init=function(){this._progress=0},t.prototype.setup=function(){if(!this.isSetup){this.isSetup=!0;var t=this;setTimeout(function(){t.startLoad()},300)}},t.prototype.startLoad=function(){var t=this;htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:102}),LoadingManager.instance.gameReport(102),this.loadResConf().then(function(e){return ResReplaceMgr.instance.executeUIAtlas(),t.updateProgress(15),t.loadResGroup(LoadingConst.preload)}).then(function(e){t.updateProgress(15)})["catch"](function(t){console.error(t)}),this.loadTempMd5().then(function(e){return t.updateProgress(15),t.loadTemplate(e)}).then(function(e){t.updateProgress(20)})["catch"](function(t){console.error(t)})},t.prototype.enterGame=function(){var t=this;this._isEnter||(this._isEnter=!0,htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:103}),LoadingManager.instance.gameReport(103),this.loadScripts().then(function(e){t.updateProgress(20),t._isCode=!0,htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:104}),LoadingManager.instance.gameReport(104);var i=egret.getDefinitionByName("LoginManager");return i&&i.instance.initMgr(LoadingManager.$stage),t.setupSocket(),t.loadThmConf()}).then(function(e){t.updateProgress(15)})["catch"](function(t){console.error(t)}))},t.prototype.setupSocket=function(){if(this._isEnter&&this._isCode){var t=egret.getDefinitionByName("LoginManager");t&&t.instance.startSocket(LoadingManager.instance)}},t.prototype.loadScripts=function(){return new Promise(function(t,e){setTimeout(function(){htgPlatSdk.loadGameScript(null,t)},200)})},t.prototype.loadThmConf=function(){var t="resource/default.thm"+htgPlatSdk.getWebVer()+".json";return new Promise(function(e,i){setTimeout(function(){var i=new eui.Theme(t,LoadingManager.$stage);i.addEventListener(eui.UIEvent.COMPLETE,e,null)},200)})},t.prototype.loadResConf=function(){return new Promise(function(t,e){var i="default.res"+htgPlatSdk.getWebVer()+".json";RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,t,null),RES.loadConfig(i,LoadingConst.res_path)})},t.prototype.loadResGroup=function(t){return new Promise(function(e,i){var n=function(r){r.groupName==t&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,null),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,n,null),r.type==RES.ResourceEvent.GROUP_COMPLETE?e(null):i())};RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,n,null),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,n,null),RES.loadGroup(t)})},t.prototype.loadTempMd5=function(){return new Promise(function(t,e){var i=LoadingConst.httpHead()+htgPlatSdk.getTempUrl(),n=htgPlatSdk.getTempVer()||"_1";LoadingConst.useLocalTemp?i="./temp/temp_md5"+n+".json":i+="/temp/temp_md5"+n+".json",RES.getResByUrl(i,function(e,i){t(e)},null,RES.ResourceItem.TYPE_JSON)})},t.prototype.loadTemplate=function(t){return new Promise(function(e,i){for(var n,r,s=t&&t.length,o=LoadingConst.httpHead()+htgPlatSdk.getTempUrl(),a=0,h=function(t,i){t&&(a++,LoadingManager.instance.allTemplateData=t),a>=s&&e(a)},l=0;s>l;l++)n=t[l],r=LoadingConst.useLocalTemp?"./temp/"+n:o+"/temp/"+n,RES.getResByUrl(r,h,null,RES.ResourceItem.TYPE_JSON)})},Object.defineProperty(t.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),t.prototype.loadProgress=function(t,e){this._callback=t,this._thisobj=e,this.updateProgress(0)},t.prototype.updateProgress=function(t){this._progress+=t,"function"==typeof this._callback&&this._callback.call(this._thisobj,this._progress)},t.prototype.dispose=function(){t._instance=null,this._callback=null,this._progress=null},t}();__reflect(PreLoadManager.prototype,"PreLoadManager");var QQMiniShare=function(t){function e(){var i=this;if(!e._instance)return i=t.call(this)||this,e._instance=i,i.init(),i}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.init=function(){if(LoadingConst.IS_WANBA||LoadingConst.IS_QQ_MINI)if(this._signKey="xdAdbkDfdDpexMccwZ",this.defaule_data={desc:"跨时代玄幻仙侠唯美游戏，邀您一起开启仙恋之旅",img_url:"share/fxmt1.jpg"},htgPlatSdk.setOnShareHandler(this.__getShareData.bind(this)),LoadingConst.IS_QQ_MINI){htgPlatSdk.registerMiniOnShow(this.__onShowHandler.bind(this)),this.__onShowHandler(htgPlatSdk.getMiniLaunchOpt());var t=LoadingConst.res_path+"share_pic/shareData.json?ran="+htgPlatSdk.getWebVer();RES.getResByUrl(t,this.__dataComplateHandler,this,RES.ResourceItem.TYPE_JSON)}else this._shareUID=parseInt(htgPlatSdk.getUrlParam(UrlParamKey.SHAREUID))||0,this._shareOpenID=htgPlatSdk.getUrlParam(UrlParamKey.SHAREOPENID)||"",this._shareTime=parseInt(htgPlatSdk.getUrlParam(UrlParamKey.SHARETIME))||0,this._shareSign=htgPlatSdk.getUrlParam(UrlParamKey.SHARESIGN)||"",console.log("shareUID:",this._shareUID,"shareOpenID:",this._shareOpenID,"shareTime:",this._shareTime,"shareSign:",this._shareSign)},e.prototype.__dataComplateHandler=function(t,e){t&&(this._shareDataArr=t)},e.prototype.shareGame=function(){(LoadingConst.IS_WANBA||LoadingConst.IS_QQ_MINI)&&htgPlatSdk&&"function"==typeof htgPlatSdk.miniShareGame&&htgPlatSdk.miniShareGame(this.__getShareData(),this.__shareResultBack.bind(this))},e.prototype.__getShareData=function(){return LoadingConst.IS_QQ_MINI?this.__getQQMiniShareData():this.__getWanbaShareData()},e.prototype.__getQQMiniShareData=function(){var t;if(this._shareDataArr){var e=Math.floor(Math.random()*this._shareDataArr.length);t=this._shareDataArr[e]}else t=this.defaule_data;var i={};i.title=t.desc,i.imageUrl=LoadingConst.res_path+t.img_url,i.query="";var n=this.__getWanbaShareData(),r=[];return r.push(UrlParamKey.SHAREUID+"="+n.shareUID),r.push(UrlParamKey.SHAREOPENID+"="+n.shareOpenID),r.push(UrlParamKey.SHARETIME+"="+n.shareTime),r.push(UrlParamKey.SHARESIGN+"="+n.shareSign),!!r.length&&(i.query=r.join("&")),i},e.prototype.__getWanbaShareData=function(){return!this.share_param&&(this.share_param={}),this._shareUID=this.share_param[UrlParamKey.SHAREUID]=this.uid||0,this._shareOpenID=this.share_param[UrlParamKey.SHAREOPENID]=this.openid||"",this._shareTime=this.share_param[UrlParamKey.SHARETIME]=this.clockMgr?this.clockMgr.serverSecond:0,this._shareSign=this.share_param[UrlParamKey.SHARESIGN]=this.getShareSign(this.share_param),this.share_param},e.prototype.getShareSign=function(t){if(!t)return"";var e=t.shareUID+t.shareOpenID+t.shareTime+this._signKey,i=GMD5.instance.hex_md5(e).toLowerCase();return i},e.prototype.checkSign=function(){if(!this.shareOpenID||!this.shareUID||!this.shareTime)return!1;var t=this.shareUID+this.shareOpenID+this.shareTime+this._signKey,e=GMD5.instance.hex_md5(t).toLowerCase();return e==this.shareSign},Object.defineProperty(e.prototype,"shareUID",{get:function(){return this._shareUID||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shareOpenID",{get:function(){return this._shareOpenID||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shareTime",{get:function(){return this._shareTime||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shareSign",{get:function(){return this._shareSign||""},enumerable:!0,configurable:!0}),e.prototype.__onShowHandler=function(t){if(this.onShowData=t,this.onShowData&&this.onShowData.query){var e=this.onShowData.query;this._shareUID=e.shareUID||0,this._shareOpenID=e.shareOpenID||"",this._shareTime=e.shareTime||0,this._shareSign=e.shareSign||""}console.log("shareUID:",this._shareUID,"shareOpenID:",this._shareOpenID,"shareTime:",this._shareTime,"shareSign:",this._shareSign),this.dispatchEventWith("SHARE_QUERY_CHANGED")},e.prototype.__shareResultBack=function(t){t&&this.dispatchEventWith("SHARE_QUERY_CHANGED")},e}(egret.EventDispatcher);__reflect(QQMiniShare.prototype,"QQMiniShare");var ResReplaceMgr=function(){function t(){this._platformResDir="",this._uiAssetData=null,this._uiAtlasData=null,t._instance=this}return Object.defineProperty(t,"instance",{get:function(){return this._instance||new t},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this._uiAssetData=null,this._callback=t,this._caller=e,this.initSnKeyReplaceRes()||this.initActivityReplaceRes()},t.prototype.initSnKeyReplaceRes=function(){var t=LoadingConst.isReplaceResSn();return t?(this._platformResDir="platformRes/"+t,RES.getResByUrl(LoadingConst.res_path+this._platformResDir+".json",this.__loadSnResComplete,this),!0):!1},t.prototype.initActivityReplaceRes=function(){var t=LoadingConst.isReplaceResThemeActivity();return t?(this._platformResDir="platformRes/"+t,void RES.getResByUrl(LoadingConst.res_path+this._platformResDir+".json",this.__loadActivityResComplete,this)):this.overCallback()},t.prototype.__loadSnResComplete=function(t){return t?(this.parseMappingData(t),void this.overCallback()):this.initActivityReplaceRes()},t.prototype.__loadActivityResComplete=function(t){return t&&this.parseMappingData(t),this.overCallback()},t.prototype.parseMappingData=function(t){var e=ResUrlController.resVersionInfo||{};for(var i in t){var n=t[i];if("UIAsset"==i){var r=this._platformResDir+"/UIAsset/",s=this._uiAssetData||{};for(var o in n)s[o]=r+n[o];this._uiAssetData=s}else if("UIAssetAtlas"==i){var a=this._uiAtlasData||{},r=this._platformResDir+"/UIAssetAtlas/";for(var h in n)a[h]=r+n[h];this._uiAtlasData=a}else if("list"==i)for(var l=n,c=0,d=l;c<d.length;c++){var g=d[c];e[g]=this._platformResDir+"/"+g}else if("map"==i){var u=n;for(var p in u)e[p]=u[p]}}ResUrlController.resVersionInfo=e},t.prototype.overCallback=function(){this._callback&&this._callback.call(this._caller),this._callback=null,this._caller=null},t.prototype.isOpenResReplace=function(){return!!ResUrlController.resVersionInfo},t.prototype.executeUIAtlas=function(){if(this._uiAtlasData)for(var t in this._uiAtlasData){var e=RES.getResourceInfo(t);e&&(e.url=this._uiAtlasData[t])}},t.prototype.getUIAsset=function(t){var e=this._uiAssetData;if(!e||!t)return null;var i=e[t];if(i)return i;var n=t.split("json.");return n.length>=2?e[n[1]]:null},t}();__reflect(ResReplaceMgr.prototype,"ResReplaceMgr"),window.ResReplaceMgr=ResReplaceMgr;var ResUrlController=function(){function t(){}return t.prototype.init=function(){return this.resRoot=LoadingConst.res_path,Promise.resolve()},t.prototype.getVirtualUrl=function(e){if(!e)return e;var i=t.resVersionInfo;if(!i)return e;var n=e.replace("\\","/");n=n.replace(this.resRoot,"");var r=i[n];return r?this.resRoot+r:e},t}();__reflect(ResUrlController.prototype,"ResUrlController",["RES.IVersionController"]);var AgeTipsPop=function(t){function e(){return t.call(this,"AgeTipsPop")||this}return __extends(e,t),e.prototype.createView=function(){this.touchEnabled=!1,this.width=500,this.height=600,this.horizontalCenter=0,this.verticalCenter=0,this.backImg=new eui.Image,this.backImg.touchEnabled=!1,this.backImg.source="loading_json.alert_back_png",this.backImg.width=500,this.addChild(this.backImg),this.backImg2=new eui.Image,this.backImg2.touchEnabled=!1,this.backImg2.y=34,this.backImg2.height=570,this.backImg2.width=500,this.backImg2.source="loading_json.alert_back_2_png",this.backImg2.scale9Grid=new egret.Rectangle(11,0,28,239),this.addChild(this.backImg2),this.contentBgImg=new eui.Image,this.contentBgImg.touchEnabled=!1,this.contentBgImg.top=43,this.contentBgImg.bottom=11,this.contentBgImg.width=480,this.contentBgImg.horizontalCenter=0,this.contentBgImg.scale9Grid=new egret.Rectangle(12,9,21,24),this.contentBgImg.source="loading_json.alert_borderbg_png",this.addChild(this.contentBgImg),this.titleLab=new eui.Label,this.titleLab.fontFamily="SimHei",this.titleLab.textAlign="center",this.titleLab.size=22,this.titleLab.textColor=14933447,this.titleLab.touchEnabled=!1,this.titleLab.width=212,this.titleLab.height=24,this.titleLab.horizontalCenter=7,this.titleLab.y=6,this.addChild(this.titleLab),this.closeBtn=new eui.Button,this.closeBtn.skinName=this.getCloseBtnSkin(),this.closeBtn.right=-12,this.closeBtn.top=-16,this.addChild(this.closeBtn),this.scroller=new eui.Scroller,this.scroller.width=470,this.scroller.height=534,this.scroller.x=15,this.scroller.y=48,this.addChild(this.scroller),this.contentTxt=new eui.Label,this.contentTxt.size=18,this.contentTxt.textColor=16380887,this.contentTxt.lineSpacing=6,this.contentTxt.width=470,this.contentTxt.x=0,this.contentTxt.y=0,this.contentGroup=new eui.Group,this.contentGroup.addChild(this.contentTxt),this.scroller.viewport=this.contentGroup,this.updateView()},e.prototype.getCloseBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="loading_json.alert_close_png",e.x=24,e.y=43,e.anchorOffsetX=24,e.anchorOffsetY=43,e.scaleX=1,e.scaleY=1,t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","scaleX",.96),new eui.SetProperty("img_1","scaleY",.96)]),new eui.State("disabled",[])],t},e.prototype.updateView=function(){return this.titleLab.text=LoadingConst.AGR_TIPS_TITLE,LoadingConst.SN_KEY?void RES.getResAsync("agetips_json",this.__dataCompleteHandler,this):void(this.contentTxt.text=LoadingConst.AGE_TIPS)},e.prototype.__dataCompleteHandler=function(t,e){if(!t)return void(this.contentTxt.text=LoadingConst.AGE_TIPS);var i=t[LoadingConst.SN_KEY];return i?void(this.contentTxt.text=i.tips):void(this.contentTxt.text=LoadingConst.AGE_TIPS)},e.prototype.initView=function(){this.createView(),this.sound=new egret.Sound,this.sound.addEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this),this.sound.load(LoadingConst.getClickSound3())},e.prototype.initEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeHandler,this)},e.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeHandler,this),this.sound&&this.sound.removeEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this)},e.prototype.__soundCompleteHandler=function(t){this.soundLoaded=!0},e.prototype.show=function(){!this.parent&&LoadingLayer.instance.addToLayer(this,1)},e.prototype.__closeHandler=function(){this.dispose()
},e.prototype.autoTouchClose=function(){return!0},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.titleLab),this.titleLab=null,LoadingConst.disposeObject(this.closeBtn),this.closeBtn=null,LoadingConst.disposeObject(this.contentTxt),this.contentTxt=null,LoadingConst.disposeObject(this.contentGroup),this.contentGroup=null,this.scroller&&(this.scroller.stopAnimation(),this.scroller.viewport=null,LoadingConst.disposeObject(this.scroller)),this.scroller=null,this.parent&&this.parent.removeChild(this),t.prototype.dispose.call(this))},e._instance=null,e.YES=1,e.NO=2,e}(LoadingBaseUI);__reflect(AgeTipsPop.prototype,"AgeTipsPop");var AgreementFrame=function(t){function e(){return t.call(this,"AgreementFrame")||this}return __extends(e,t),e.prototype.createView=function(){this.labArr=[],this.width=488,this.height=762,this.verticalCenter=0,this.horizontalCenter=0,this.titleImg=new eui.Image,this.titleImg.source="loading_json.alert_back_png",this.titleImg.touchEnabled=!1,this.titleImg.scale9Grid=new egret.Rectangle(173,9,103,18),this.titleImg.width=502,this.addChild(this.titleImg),this.backImg=new eui.Image,this.backImg.source="loading_json.alert_back_2_png",this.backImg.scale9Grid=new egret.Rectangle(12,32,18,195),this.backImg.height=709,this.backImg.width=500,this.backImg.y=34,this.backImg.x=0,this.backImg.touchEnabled=!1,this.addChild(this.backImg),this.rectImg=new eui.Image,this.rectImg.source="loading_json.alert_borderbg_png",this.rectImg.scale9Grid=new egret.Rectangle(15,15,6,5),this.rectImg.width=480,this.rectImg.height=630,this.rectImg.x=10,this.rectImg.y=40,this.rectImg.touchEnabled=!1,this.addChild(this.rectImg),this.titleTxt=new eui.Label,this.titleTxt.size=22,this.titleTxt.fontFamily="SimHei",this.titleTxt.textAlign="center",this.titleTxt.touchEnabled=!1,this.titleTxt.textColor=16380887,this.titleTxt.width=120,this.titleTxt.height=22,this.titleTxt.horizontalCenter=15,this.titleTxt.y=7,this.addChild(this.titleTxt),this.contentGroup=new eui.Group;var t=new eui.VerticalLayout;t.gap=4,this.contentGroup.layout=t,this.listScroller=new eui.Scroller,this.listScroller.anchorOffsetX=0,this.listScroller.anchorOffsetY=0,this.listScroller.width=470,this.listScroller.height=620,this.listScroller.x=15,this.listScroller.y=45,this.listScroller.viewport=this.contentGroup,this.addChild(this.listScroller),this.closeBtn=new eui.Button,this.closeBtn.skinName=this.getCloseBtnSkin(),this.closeBtn.x=459,this.closeBtn.y=-18,this.addChild(this.closeBtn),this.confirmBtn=new eui.Button,this.confirmBtn.skinName=this.getConfirmBtnSkin(),this.confirmBtn.horizontalCenter=0,this.confirmBtn.y=683,this.addChild(this.confirmBtn)},e.prototype.getCloseBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="loading_json.alert_close_png",t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2)]),new eui.State("disabled",[])],t},e.prototype.getConfirmBtnSkin=function(){var t=new eui.Skin;t.skinParts=["labelDisplay"];var e=new eui.Image;e.source="loading_json.alert_confirm_png";var i=new eui.Label;return i.size=20,i.height=20,i.percentWidth=100,i.verticalCenter=0,i.textColor=7751207,i.textAlign="center",t.img_1=e,t.labelDisplay=i,t.elementsContent=[e,i],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2),new eui.SetProperty("labelDisplay","verticalCenter","-2")]),new eui.State("disabled",[])],t},e.prototype.initView=function(){this.createView(),this.confirmBtn.label=LoadingConst.MSG_13},e.prototype.initEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeBtnClickHandler,this),this.confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__confirmBtnHandler,this)},e.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeBtnClickHandler,this),this.confirmBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__confirmBtnHandler,this)},e.prototype.initData=function(){this.updateView()},e.prototype.updateView=function(){var t=this;if(this.initFinish&&this._type){this.titleTxt.text=LoadingConst.MSG_11;var e=this.getTxtKey();RES.getResAsync(e).then(function(e){if(e){var i=e.split("$$$");console.log("文本分割长度"+i.length);for(var n=0;n<i.length;n++){var r=new eui.Label;r.size=20,r.fontFamily="SimHei",r.touchEnabled=!1,r.textColor=16250612,r.width=470,r.text=i[n],t.contentGroup.addChild(r)}}})}},e.prototype.getTxtKey=function(){var t=""+this.type;return t+=PlatformSnKey.isGanke(LoadingConst.SN_KEY)?"_gk_txt":PlatformSnKey.isAwy(LoadingConst.SN_KEY)?"_awy_txt":PlatformSnKey.isFzml(LoadingConst.SN_KEY)?"_fzml_txt":LoadingConst.IS_DHDL?"_dhdl_txt":"_txt"},e.prototype.show=function(t){this._type=t,this.updateView(),!this.parent&&LoadingLayer.instance.addToLayer(this)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e.prototype.__closeBtnClickHandler=function(t){LoadingConst.disposeObject(this)},e.prototype.__confirmBtnHandler=function(t){this.confirmed=!0,this.__closeBtnClickHandler(t)},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.titleImg),this.titleImg=null,LoadingConst.disposeObject(this.closeBtn),this.closeBtn=null,LoadingConst.disposeObject(this.titleTxt),this.titleTxt=null,LoadingConst.disposeObject(this.backImg),this.backImg=null,LoadingConst.disposeObject(this.rectImg),this.rectImg=null,LoadingConst.disposeObject(this.contentGroup),this.contentGroup=null,this.listScroller&&(this.listScroller.stopAnimation(),this.listScroller.viewport=null,LoadingConst.disposeObject(this.listScroller)),this.listScroller=null,t.prototype.dispose.call(this),this.dispatchEventWith(egret.Event.CLOSE,!1,this.confirmed))},e}(LoadingBaseUI);__reflect(AgreementFrame.prototype,"AgreementFrame");var AgreementView=function(t){function e(){return t.call(this,"AgreementView")||this}return __extends(e,t),e.prototype.createView=function(){this.agreeBtn=new eui.CheckBox,this.agreeBtn.skinName=this.getAgreeBtnSkin(),this.agreeBtn.x=0,this.agreeBtn.y=0,this.addChild(this.agreeBtn),this.userBtn=new eui.Button,this.userBtn.skinName=this.getBtnSkin(),this.userBtn.x=205,this.userBtn.y=7,this.addChild(this.userBtn),this.privacyBtn=new eui.Button,this.privacyBtn.skinName=this.getBtnSkin(),this.privacyBtn.x=291,this.privacyBtn.y=7,this.addChild(this.privacyBtn)},e.prototype.getAgreeBtnSkin=function(){var t=new eui.Skin;t.height=28,t.skinParts=["img","labelDisplay"];var e=new eui.Image;e.source="loading_json.alert_check_btn_2_png";var i=new eui.Label;return i.size=18,i.height=18,i.left=29,i.y=7,i.textColor=16755517,i.stroke=1,i.strokeColor=68372,t.img=e,t.labelDisplay=i,t.elementsContent=[e,i],t.states=[new eui.State("up",[new eui.SetProperty("img","source","loading_json.alert_check_btn_1_png")]),new eui.State("down",[new eui.SetProperty("img","source","loading_json.alert_check_btn_1_png"),new eui.SetProperty("labelDisplay","y",6)]),new eui.State("upAndSelected",[]),new eui.State("downAndSelected",[new eui.SetProperty("labelDisplay","y",6)])],t},e.prototype.getBtnSkin=function(){var t=new eui.Skin;t.height=18,t.skinParts=["labelDisplay"];var e=new eui.Label;return e.size=18,e.height=18,e.textColor=16723245,e.stroke=.5,e.strokeColor=68372,t.labelDisplay=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("labelDisplay","y",-1)])],t},e.prototype.initView=function(){this.createView(),this.width=364,this.height=30,this.agreeBtn.label=LoadingConst.MSG_9,this.agreeBtn.$autoSelected=!1,this.userBtn.labelDisplay.textFlow=LoadingConst.getHtmlFlow("<u>"+LoadingConst.MSG_10+"</u>"),this.privacyBtn.labelDisplay.textFlow=LoadingConst.getHtmlFlow("<u>"+LoadingConst.MSG_11+"</u>")},e.prototype.initEvent=function(){this.userBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__openUserHandler,this),this.privacyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__openPrivacyHandler,this),this.agreeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__agreeChangeHandler,this)},e.prototype.removeEvent=function(){this.userBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__openUserHandler,this),this.privacyBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__openPrivacyHandler,this),this.agreeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__agreeChangeHandler,this)},e.prototype.initData=function(){for(var t,e=LoadingManager.instance.loginData,i=e&&e.s||[],n=i.length,r=0;n>r;r++)if(t=i[r],t&&!t.isnew){this.agreeBtn.selected=this.readPrived=this.readUsered=!0;break}},e.prototype.__agreeChangeHandler=function(t){this.agreeBtn.selected?this.agreeBtn.selected=!1:this.readUsered?this.readPrived?this.agreeBtn.selected=!0:this.__openPrivacyHandler(null):this.__openUserHandler(null)},e.prototype.__openUserHandler=function(t){this.view&&!this.view.destory&&(LoadingConst.disposeObject(this.view),this.view.removeEventListener(egret.Event.CLOSE,this.__userCloseHandler,this)),this.view=new AgreementFrame,this.view.addEventListener(egret.Event.CLOSE,this.__userCloseHandler,this)},e.prototype.__userCloseHandler=function(t){t.target.removeEventListener(egret.Event.CLOSE,this.__userCloseHandler,this),!this.readUsered&&(this.readUsered=!!t.data)},e.prototype.__openPrivacyHandler=function(t){this.view&&!this.view.destory&&LoadingConst.disposeObject(this.view),this.view=new AgreementFrame,this.view.addEventListener(egret.Event.CLOSE,this.__privacyCloseHandler,this)},e.prototype.__privacyCloseHandler=function(t){t.target.removeEventListener(egret.Event.CLOSE,this.__privacyCloseHandler,this),!this.readPrived&&(this.readPrived=!!t.data)},Object.defineProperty(e.prototype,"selected",{get:function(){return this.agreeBtn&&this.agreeBtn.selected},set:function(t){this.agreeBtn&&(this.agreeBtn.selected=t)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.agreeBtn),this.agreeBtn=null,LoadingConst.disposeObject(this.userBtn),this.userBtn=null,LoadingConst.disposeObject(this.privacyBtn),this.privacyBtn=null,this.view&&!this.view.destory&&(this.view.removeEventListener(egret.Event.CLOSE,this.__userCloseHandler,this),this.view.removeEventListener(egret.Event.CLOSE,this.__privacyCloseHandler,this),LoadingConst.disposeObject(this.view)),this.view=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(AgreementView.prototype,"AgreementView");var ChangeOpenIdView=function(t){function e(){return t.call(this,"LoginView")||this}return __extends(e,t),e.prototype.createView=function(){this.width=540,this.height=960,this.verticalCenter=0,this.horizontalCenter=0,this.enterGameBtn=new eui.Button,this.enterGameBtn.skinName=this.getStartGameBtnSkin(),this.enterGameBtn.width=139,this.enterGameBtn.height=58,this.enterGameBtn.horizontalCenter=0,this.enterGameBtn.bottom=200,this.addChild(this.enterGameBtn),this.nameBackImg=new eui.Image,this.nameBackImg.touchEnabled=!1,this.nameBackImg.source="loading_json.alert_back_png",this.nameBackImg.scale9Grid=new egret.Rectangle(12,12,344,167),this.nameBackImg.width=500,this.nameBackImg.height=30,this.nameBackImg.horizontalCenter=0,this.nameBackImg.bottom=300,this.addChild(this.nameBackImg),this.nickNameTxt=new eui.EditableText,this.nickNameTxt.fontFamily="SimHei",this.nickNameTxt.maxChars=50,this.nickNameTxt.size=22,this.nickNameTxt.stroke=1,this.nickNameTxt.strokeColor=69145,this.nickNameTxt.text="",this.nickNameTxt.textAlign="center",this.nickNameTxt.textColor=15460053,this.nickNameTxt.verticalAlign="middle",this.nickNameTxt.restrict="a-zA-Z_0-9",this.nickNameTxt.width=500,this.nickNameTxt.horizontalCenter=0,this.nickNameTxt.bottom=300,this.addChild(this.nickNameTxt)},e.prototype.getStartGameBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new egret.Bitmap;return e.touchEnabled=!1,e.texture=RES.getRes("loading_json.alert_confirm_png"),t.back=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("back","y",-2)]),new eui.State("disabled",[])],t},e.prototype.getRandowmBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="selectrole_json.select_role_random_png",t.backimg=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("backimg","y",-2)]),new eui.State("disabled",[])],t},e.prototype.initView=function(){this.createView()},e.prototype.initEvent=function(){this.enterGameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__enterGameHandler,this)},e.prototype.removeEvent=function(){this.enterGameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__enterGameHandler,this)},e.prototype.initData=function(){this.updateView()},e.prototype.updateView=function(){this.initFinish&&this.resData&&(this.nickNameTxt.text=this.resData.data.openId||"")},e.prototype.__enterGameHandler=function(t){var e=this.nickNameTxt.text;if(!e)return void LoadingAlert.show("openId فارغ!",void 0,LoadingAlert.YES);var i=this.callBack,n=this.resData||{data:{}};this.dispose(),"function"==typeof i&&(e!=n.data.openId&&(n.data.openId=e,n.data.debug=1),i(n))},e.prototype.show=function(t,e){this.resData=t||{data:{}},this.callBack=e,this.updateView(),LoadingLayer.instance.addToLayer(this)},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.enterGameBtn),this.enterGameBtn=null,LoadingConst.disposeObject(this.nickNameTxt),this.nickNameTxt=null,this.callBack=null,this.resData=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(ChangeOpenIdView.prototype,"ChangeOpenIdView"),eui.HtgEditorLabel=eui.EditableText;var EditableLabelArab=function(t){function e(){var e=t.call(this)||this,i=e.$UIComponent;return i[1e3]=0,i[1001]=0,i[1002]=0,i[1003]=0,e.scaleX=1,e.textAlign=egret.HorizontalAlign.LEFT,e}return __extends(e,t),e.prototype.$setX=function(e){var i=this.$UIComponent[1e3]-this.$UIComponent[1002];return this.$UIComponent[1002]=this.$UIComponent[1e3],t.prototype.$setX.call(this,e+i)},e.prototype.$setScaleX=function(e){t.prototype.$setScaleX.call(this,-1*e)},e.prototype.$setTextAlign=function(e){var i=(n={},n[egret.HorizontalAlign.LEFT]=egret.HorizontalAlign.RIGHT,n[egret.HorizontalAlign.RIGHT]=egret.HorizontalAlign.LEFT,n);return e=i[e]||e,t.prototype.$setTextAlign.call(this,e);var n},e.prototype.$setAnchorOffsetX=function(e){t.prototype.$setAnchorOffsetX.call(this,e+this.$UIComponent[1001]-this.$UIComponent[1003]),this.$UIComponent[1003]=this.$UIComponent[1001]},e}(eui.HtgEditorLabel);__reflect(EditableLabelArab.prototype,"EditableLabelArab");var EditableLabelArabSetActualSize=EditableLabelArab.prototype.setActualSize;EditableLabelArab.prototype.setActualSize=function(t,e){if(EditableLabelArabSetActualSize){EditableLabelArabSetActualSize.apply(this,[t,e]);var i=!1,n=this.$UIComponent;n[10]!==t&&(n[10]=t,i=!0),n[11]!==e&&(n[11]=e,i=!0),i=i||this.$UIComponent[1004]!=(this.$UIComponent[10]||0),i&&(this.$UIComponent[1004]=this.$UIComponent[10]||0,this.$UIComponent[1e3]=this.$UIComponent[1001]=Math.ceil(.5*this.$UIComponent[10]),this.anchorOffsetX=this.$anchorOffsetX||0,this.x=this.$x)}},eui.Component.prototype.setSkinPart=function(t,e){var i=this[t];if(i&&this.partRemoved(t,i),this[t]=e,e&&(this.partAdded(t,e),e.name||(e.name=t),e instanceof eui.Label)){var n=e.$TextField;n[3]||n[4]||(e.isNoSet=!0)}},Object.defineProperty(egret.TextField.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t),this.isNoSet&&t&&(this.isNoSet=!1,this.$setText(this.text))},enumerable:!0,configurable:!0}),Object.defineProperty(egret.TextField.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t),this.isNoSet&&t&&(this.isNoSet=!1,this.$setText(this.text))},enumerable:!0,configurable:!0}),window.egretOverride=egretOverride;var GMD5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),r=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],r[s]=1549556828^i[s];var o=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(r.concat(o),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",s=0;s<t.length;s++)i=t.charCodeAt(s),r+=n.charAt(i>>>4&15)+n.charAt(15&i);return r},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",r=t.length,s=0;r>s;s+=3)for(var o=t.charCodeAt(s)<<16|(r>s+1?t.charCodeAt(s+1)<<8:0)|(r>s+2?t.charCodeAt(s+2):0),a=0;4>a;a++)n+=8*s+6*a>8*t.length?this.b64pad:i.charAt(o>>>6*(3-a)&63);return n},t.prototype.rstr2any=function(t,e){var i,n,r,s,o,a=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(l);for(n=0;l>n;n++){for(o=Array(),s=0,i=0;i<h.length;i++)s=(s<<16)+h[i],r=Math.floor(s/a),s-=r*a,(o.length>0||r>0)&&(o[o.length]=r);c[n]=s,h=o}var d="";for(i=c.length-1;i>=0;i--)d+=e.charAt(c[i]);return d},t.prototype.str2rstr_utf8=function(t){for(var e,i,n="",r=-1;++r<t.length;)e=t.charCodeAt(r),i=r+1<t.length?t.charCodeAt(r+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),r++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,r=-1732584194,s=271733878,o=0;o<t.length;o+=16){var a=i,h=n,l=r,c=s;i=this.md5_ff(i,n,r,s,t[o+0],7,-680876936),s=this.md5_ff(s,i,n,r,t[o+1],12,-389564586),r=this.md5_ff(r,s,i,n,t[o+2],17,606105819),n=this.md5_ff(n,r,s,i,t[o+3],22,-1044525330),i=this.md5_ff(i,n,r,s,t[o+4],7,-176418897),s=this.md5_ff(s,i,n,r,t[o+5],12,1200080426),r=this.md5_ff(r,s,i,n,t[o+6],17,-1473231341),n=this.md5_ff(n,r,s,i,t[o+7],22,-45705983),i=this.md5_ff(i,n,r,s,t[o+8],7,1770035416),s=this.md5_ff(s,i,n,r,t[o+9],12,-1958414417),r=this.md5_ff(r,s,i,n,t[o+10],17,-42063),n=this.md5_ff(n,r,s,i,t[o+11],22,-1990404162),i=this.md5_ff(i,n,r,s,t[o+12],7,1804603682),s=this.md5_ff(s,i,n,r,t[o+13],12,-40341101),r=this.md5_ff(r,s,i,n,t[o+14],17,-1502002290),n=this.md5_ff(n,r,s,i,t[o+15],22,1236535329),i=this.md5_gg(i,n,r,s,t[o+1],5,-165796510),s=this.md5_gg(s,i,n,r,t[o+6],9,-1069501632),r=this.md5_gg(r,s,i,n,t[o+11],14,643717713),n=this.md5_gg(n,r,s,i,t[o+0],20,-373897302),i=this.md5_gg(i,n,r,s,t[o+5],5,-701558691),s=this.md5_gg(s,i,n,r,t[o+10],9,38016083),r=this.md5_gg(r,s,i,n,t[o+15],14,-660478335),n=this.md5_gg(n,r,s,i,t[o+4],20,-405537848),i=this.md5_gg(i,n,r,s,t[o+9],5,568446438),s=this.md5_gg(s,i,n,r,t[o+14],9,-1019803690),r=this.md5_gg(r,s,i,n,t[o+3],14,-187363961),n=this.md5_gg(n,r,s,i,t[o+8],20,1163531501),i=this.md5_gg(i,n,r,s,t[o+13],5,-1444681467),s=this.md5_gg(s,i,n,r,t[o+2],9,-51403784),r=this.md5_gg(r,s,i,n,t[o+7],14,1735328473),n=this.md5_gg(n,r,s,i,t[o+12],20,-1926607734),i=this.md5_hh(i,n,r,s,t[o+5],4,-378558),s=this.md5_hh(s,i,n,r,t[o+8],11,-2022574463),r=this.md5_hh(r,s,i,n,t[o+11],16,1839030562),n=this.md5_hh(n,r,s,i,t[o+14],23,-35309556),i=this.md5_hh(i,n,r,s,t[o+1],4,-1530992060),s=this.md5_hh(s,i,n,r,t[o+4],11,1272893353),r=this.md5_hh(r,s,i,n,t[o+7],16,-155497632),n=this.md5_hh(n,r,s,i,t[o+10],23,-1094730640),i=this.md5_hh(i,n,r,s,t[o+13],4,681279174),s=this.md5_hh(s,i,n,r,t[o+0],11,-358537222),r=this.md5_hh(r,s,i,n,t[o+3],16,-722521979),n=this.md5_hh(n,r,s,i,t[o+6],23,76029189),i=this.md5_hh(i,n,r,s,t[o+9],4,-640364487),s=this.md5_hh(s,i,n,r,t[o+12],11,-421815835),r=this.md5_hh(r,s,i,n,t[o+15],16,530742520),n=this.md5_hh(n,r,s,i,t[o+2],23,-995338651),i=this.md5_ii(i,n,r,s,t[o+0],6,-198630844),s=this.md5_ii(s,i,n,r,t[o+7],10,1126891415),r=this.md5_ii(r,s,i,n,t[o+14],15,-1416354905),n=this.md5_ii(n,r,s,i,t[o+5],21,-57434055),i=this.md5_ii(i,n,r,s,t[o+12],6,1700485571),s=this.md5_ii(s,i,n,r,t[o+3],10,-1894986606),r=this.md5_ii(r,s,i,n,t[o+10],15,-1051523),n=this.md5_ii(n,r,s,i,t[o+1],21,-2054922799),i=this.md5_ii(i,n,r,s,t[o+8],6,1873313359),s=this.md5_ii(s,i,n,r,t[o+15],10,-30611744),r=this.md5_ii(r,s,i,n,t[o+6],15,-1560198380),n=this.md5_ii(n,r,s,i,t[o+13],21,1309151649),i=this.md5_ii(i,n,r,s,t[o+4],6,-145523070),s=this.md5_ii(s,i,n,r,t[o+11],10,-1120210379),r=this.md5_ii(r,s,i,n,t[o+2],15,718787259),n=this.md5_ii(n,r,s,i,t[o+9],21,-343485551),i=this.safe_add(i,a),n=this.safe_add(n,h),r=this.safe_add(r,l),s=this.safe_add(s,c)}return[i,n,r,s]},t.prototype.md5_cmn=function(t,e,i,n,r,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),r),i)},t.prototype.md5_ff=function(t,e,i,n,r,s,o){return this.md5_cmn(e&i|~e&n,t,e,r,s,o)},t.prototype.md5_gg=function(t,e,i,n,r,s,o){return this.md5_cmn(e&n|i&~n,t,e,r,s,o)},t.prototype.md5_hh=function(t,e,i,n,r,s,o){return this.md5_cmn(e^i^n,t,e,r,s,o)},t.prototype.md5_ii=function(t,e,i,n,r,s,o){return this.md5_cmn(i^(e|~n),t,e,r,s,o)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},Object.defineProperty(t,"instance",{get:function(){return this._md5Instance||(this._md5Instance=new t,this._md5Instance)},enumerable:!0,configurable:!0}),t}();__reflect(GMD5.prototype,"GMD5"),eui.HtgSroller=eui.Scroller;var SrollerArab=function(t){function e(){var e=t.call(this)||this,i=e.$Scroller[8];return i=null,i=new eui.sys.HTouchScroll(e.horizontalUpdateHandler,e.horizontalEndHandler,e),e.$Scroller[8]=i,e}return __extends(e,t),e}(eui.HtgSroller);__reflect(SrollerArab.prototype,"SrollerArab"),egret.HtgHtmlTextParser=egret.HtmlTextParser;var HtmlTextParserArab=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.parser=function(e){if(!e)return t.prototype.parse.call(this,e);var i=e.charCodeAt(0);return 8295!=i&&(e="⁧"+e),t.prototype.parse.call(this,e)},e}(egret.HtgHtmlTextParser);__reflect(HtmlTextParserArab.prototype,"HtmlTextParserArab");var eui;!function(t){var e;!function(e){function i(){t.sys.HTouchScroll.prototype.onTick=function(t){var e=t-this.previousTime;if(e>10){var i=this.previousVelocity;i.length>=n&&i.shift(),this.velocity=(this.currentPosition-this.previousPosition)/e,i.push(this.velocity),this.previousTime=t,this.previousPosition=this.currentPosition}return!0},t.sys.HTouchScroll.prototype.throwTo=function(t,e){void 0===e&&(e=500);var i=this.currentScrollPos;if(i==t)return void this.endFunction.call(this.target);var n=this.animation;n.duration=e,n.from=i,n.to=t,n.play()}}var n=4,r=[1,1.33,1.66,2],s=2.33,o=.02,a=.998,h=.95,l=Math.log(a),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.update=function(t,e,i){e=Math.max(e,0),this.currentPosition=t,this.maxScrollPos=e;var n=t-this.offsetPoint,r=n+i;this.offsetPoint=t,0>r&&(this.$bounces?r-=.5*n:r=0),r>e&&(this.$bounces?r-=.5*n:r=e),this.currentScrollPos=r,this.updateFunction.call(this.target,r)},e.prototype.finish=function(t,e){egret.stopTick(this.onTick,this),this.started=!1;for(var i=this.velocity*s,n=this.previousVelocity,c=n.length,d=s,g=0;c>g;g++){var u=r[g];i+=n[0]*u,d+=u}var p=i/d,_=Math.abs(p),m=0,f=0;if(_>o)if(f=t-(p-o)/l*2*this.$scrollFactor,0>f||f>e)for(f=t;Math.abs(p)>o;)f+=p,p*=0>f||f>e?a*h:a,m++;else m=Math.log(o/_)/l;else f=t;if(this.target.$getThrowInfo){var v=this.target.$getThrowInfo(t,f);f=v.toPos}m>0?(this.$bounces||(0>f?f=0:f>e&&(f=e)),this.throwTo(f,m)):this.finishScrolling()},e}(t.sys.TouchScroll);e.HTouchScroll=c,__reflect(c.prototype,"eui.sys.HTouchScroll"),e.overideHTouchScroll=i}(e=t.sys||(t.sys={}))}(eui||(eui={})),eui.HtgLabel=eui.Label;var LabelArab=function(t){function e(e){var i=t.call(this,e)||this,n=i.$UIComponent;return n[1e3]=0,n[1001]=0,n[1004]=0,n[1005]=0,i.scaleX=1,i.textAlign=egret.HorizontalAlign.LEFT,i}return __extends(e,t),Object.defineProperty(e.prototype,"x",{get:function(){return this.$UIComponent[1005]},set:function(t){this.$UIComponent[1005]=t;var i=this.$UIComponent[1e3];egret.superSetter(e,this,"x",t+i)},enumerable:!0,configurable:!0}),e.prototype.$setScaleX=function(e){t.prototype.$setScaleX.call(this,-1*e)},e.prototype.$setTextAlign=function(e){var i=(n={},n[egret.HorizontalAlign.LEFT]=egret.HorizontalAlign.RIGHT,n[egret.HorizontalAlign.RIGHT]=egret.HorizontalAlign.LEFT,n);return e=i[e]||e,t.prototype.$setTextAlign.call(this,e);var n},e.prototype.$setAnchorOffsetX=function(e){this.$UIComponent[1001]=e,t.prototype.$setAnchorOffsetX.call(this,e+this.$UIComponent[1e3])},e}(eui.HtgLabel);__reflect(LabelArab.prototype,"LabelArab");var LabelArabSetActualSize=LabelArab.prototype.setActualSize;LabelArab.prototype.setActualSize=function(t,e){if(LabelArabSetActualSize){LabelArabSetActualSize.apply(this,[t,e]);var i=!1;i=this.$UIComponent[1004]!=(this.$UIComponent[10]||0),i&&(this.$UIComponent[1004]=this.$UIComponent[10]||0,this.$UIComponent[1e3]=Math.ceil(.5*this.$UIComponent[10]),this.anchorOffsetX=this.$UIComponent[1001],this.x=this.$UIComponent[1005])}};var LoadingAlert=function(t){function e(){var i=t.call(this,"LoadingAlert")||this;return e._instance?i:(e._instance=i,i)}return __extends(e,t),e.prototype.createView=function(){this.touchEnabled=!1,this.width=442,this.height=269,this.horizontalCenter=0,this.verticalCenter=0,this.backImg=new eui.Image,this.backImg.touchEnabled=!1,this.backImg.source="loading_json.alert_back_png",this.addChild(this.backImg),this.backImg2=new eui.Image,this.backImg2.touchEnabled=!1,this.backImg2.y=34,this.backImg2.height=235,this.backImg2.width=442,this.backImg2.source="loading_json.alert_back_2_png",this.backImg2.scale9Grid=new egret.Rectangle(11,0,28,239),this.addChild(this.backImg2),this.contentBgImg=new eui.Image,this.contentBgImg.touchEnabled=!1,this.contentBgImg.top=43,this.contentBgImg.bottom=90,this.contentBgImg.width=419,this.contentBgImg.horizontalCenter=0,this.contentBgImg.scale9Grid=new egret.Rectangle(12,9,21,24),this.contentBgImg.source="loading_json.alert_borderbg_png",this.addChild(this.contentBgImg),this.titleLab=new eui.Label,this.titleLab.fontFamily="SimHei",this.titleLab.textAlign="center",this.titleLab.size=22,this.titleLab.textColor=14933447,this.titleLab.touchEnabled=!1,this.titleLab.width=212,this.titleLab.height=24,this.titleLab.horizontalCenter=7,this.titleLab.y=6,this.addChild(this.titleLab),this.contextLab=new eui.Label,this.contextLab.fontFamily="SimHei",this.contextLab.textAlign="center",this.contextLab.verticalAlign="middle",this.contextLab.lineSpacing=5,this.contextLab.size=17,this.contextLab.text="",this.contextLab.textColor=16380887,this.contextLab.touchEnabled=!1,this.contextLab.width=400,this.contextLab.verticalCenter=-20,this.contextLab.horizontalCenter=0,this.addChild(this.contextLab),this.closeBtn=new eui.Button,this.closeBtn.skinName=this.getCloseBtnSkin(),this.closeBtn.right=-12,this.closeBtn.top=-16,this.addChild(this.closeBtn),this.yesBtn=new eui.Button,this.yesBtn.skinName=this.getYesAndNoBtnSkin(),this.yesBtn.icon="loading_json.alert_confirm_png",this.yesBtn.width=107,this.yesBtn.height=45,this.noBtn=new eui.Button,this.noBtn.skinName=this.getYesAndNoBtnSkin(!1),this.noBtn.icon="loading_json.alert_cancel_png",this.noBtn.width=107,this.noBtn.height=45;var t=new eui.HorizontalLayout;t.gap=50,this.btnGroup=new eui.Group,this.btnGroup.horizontalCenter=0,this.btnGroup.bottom=24,this.btnGroup.touchEnabled=!1,this.btnGroup.layout=t,this.addChild(this.btnGroup)},e.prototype.getCloseBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="loading_json.alert_close_png",e.x=24,e.y=43,e.anchorOffsetX=24,e.anchorOffsetY=43,e.scaleX=1,e.scaleY=1,t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","scaleX",.96),new eui.SetProperty("img_1","scaleY",.96)]),new eui.State("disabled",[])],t},e.prototype.getYesAndNoBtnSkin=function(t){void 0===t&&(t=!0);var e=new eui.Skin;e.skinParts=["iconDisplay","labelDisplay"];var i=new eui.Image;i.touchEnabled=!1,i.x=53,i.y=22,i.anchorOffsetX=53,i.anchorOffsetY=22,i.scaleX=1,i.scaleY=1,e.iconDisplay=i;var n=new eui.Label;return n.fontFamily="SimHei",n.textAlign="center",n.size=20,n.textColor=t?7751207:2054448,n.touchEnabled=!1,n.percentWidth=100,n.height=20,n.x=0,n.verticalCenter=0,e.labelDisplay=n,e.elementsContent=[i,n],e.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("iconDisplay","scaleX",.96),new eui.SetProperty("iconDisplay","scaleY",.96)]),new eui.State("disabled",[])],e},Object.defineProperty(e,"instance",{get:function(){return this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.createView(),this._btnArr=[],this.titleLab.text="نصائح",this.noBtn.label="إلغاء",this.yesBtn.label="حسنا",this.sound=new egret.Sound,this.sound.addEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this),this.sound.load(LoadingConst.getClickSound3())},e.prototype.initEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__cancelClickHandler,this),this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__cancelClickHandler,this),this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__confirmClickHandler,this)},e.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__cancelClickHandler,this),this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__cancelClickHandler,this),this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__confirmClickHandler,this),this.sound&&this.sound.removeEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this)},e.prototype.__soundCompleteHandler=function(t){this.soundLoaded=!0},e.show=function(t,i,n,r,s,o,a){void 0===r&&(r=null),void 0===s&&(s=null),void 0===a&&(a=null),i||(i="نصائح"),n||(n=e.YES|e.NO),this.instance.show(t,i,n,r,s,o,a)},e.prototype.show=function(t,i,n,r,s,o,a){this._confirmCall=r,this._cancelCall=a,this._thisObj=s,this._callArg=o,this.titleLab&&(this.titleLab.text=i),this.setContext(t),this.btnGroup.removeChildren(),this._btnArr.length=0,n&e.NO&&this.btnGroup.addChild(this.noBtn),n&e.YES&&this.btnGroup.addChild(this.yesBtn),LoadingLayer.instance.addToLayer(this,1)
},e.prototype.setContext=function(t){t=void 0==t||null==t?"":t.toString(),t.indexOf("</")>=0?this.contextLab.textFlow=(new egret.HtmlTextParser).parser(t):this.contextLab.text=t},e.prototype.__cancelClickHandler=function(t){this.soundLoaded&&this.sound&&this.sound.play(0,1);var e=this._cancelCall,i=this._thisObj,n=this._callArg;this.hide(),e&&(n?e.apply(i,n):e.call(i))},e.prototype.__confirmClickHandler=function(t){this.soundLoaded&&this.sound&&this.sound.play(0,1);var e=this._confirmCall,i=this._thisObj,n=this._callArg;this.hide(),e&&(n?e.apply(i,n):e.call(i))},e.prototype.hide=function(){this._confirmCall=null,this._cancelCall=null,this._thisObj=null,this._callArg=null,this.parent&&this.parent.removeChild(this),this._btnArr.length=0},e.prototype.dispose=function(){this.destory||(this.removeEvent(),this.hide(),LoadingConst.disposeObject(this.titleLab),this.titleLab=null,LoadingConst.disposeObject(this.yesBtn),this.yesBtn=null,LoadingConst.disposeObject(this.noBtn),this.noBtn=null,LoadingConst.disposeObject(this.closeBtn),this.closeBtn=null,LoadingConst.disposeObject(this.contextLab),this.contextLab=null,RES.destroyRes("loading_json"),t.prototype.dispose.call(this))},e._instance=null,e.YES=1,e.NO=2,e}(LoadingBaseUI);__reflect(LoadingAlert.prototype,"LoadingAlert");var LoadingBonesDisplay=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._name},set:function(t){this._name!=t&&(this._name=t,this._isplay=!1,this.dbData=null,this.ttrData=null,this.ttr=null,this._dburl=this._name+"/bones_ske.json",RES.getResByUrl(this._dburl,this.__dbDataHandler,this,RES.ResourceItem.TYPE_JSON),this._ttdurl=this._name+"/bones_tex.json",RES.getResByUrl(this._ttdurl,this.__ttrDataHandler,this,RES.ResourceItem.TYPE_JSON),this._ttrurl=this._name+"/bones_tex.png",RES.getResByUrl(this._ttrurl,this.__ttrHandler,this,RES.ResourceItem.TYPE_IMAGE))},enumerable:!0,configurable:!0}),e.prototype.__dbDataHandler=function(t,e){e==this._dburl&&(this.dbData=t,this.loadOver())},e.prototype.__ttrDataHandler=function(t,e){e==this._ttdurl&&(this.ttrData=t,this.loadOver())},e.prototype.__ttrHandler=function(t,e){e==this._ttrurl&&(this.ttr=t,this.loadOver())},e.prototype.loadOver=function(){if(this.dbData&&this.ttrData&&this.ttr){var t=dragonBones.EgretFactory.factory;t.parseDragonBonesData(this.dbData,this._name),t.parseTextureAtlasData(this.ttrData,this.ttr,this._name),this._dbDisplay=t.buildArmatureDisplay("bonesAvatar",this._name),this._dbDisplay&&this.addChild(this._dbDisplay),this.updatePlay()}},e.prototype.play=function(){this._isplay=!0,this.updatePlay()},e.prototype.stop=function(){this._isplay=!1,this.updatePlay()},e.prototype.updatePlay=function(){this._dbDisplay&&(this._isplay?this._dbDisplay.animation.play("s"):this._dbDisplay.animation.stop("s"))},e.prototype.dispose=function(){this._dbDisplay&&(this._dbDisplay.animation.stop(),this._dbDisplay.parent&&this._dbDisplay.parent.removeChild(this._dbDisplay),this._dbDisplay.dispose(!0)),this._dbDisplay=null,RES.destroyRes(this._dburl),RES.destroyRes(this._ttdurl),RES.destroyRes(this._ttrurl);var t=dragonBones.EgretFactory.factory;t&&t.clear()},e}(egret.DisplayObjectContainer);__reflect(LoadingBonesDisplay.prototype,"LoadingBonesDisplay");var TextFieldArab=function(t){function e(){var e=t.call(this)||this;e.scaleX=1;var i=e.$TextField;return i[1e3]=0,e}return __extends(e,t),e.prototype.$setX=function(e){var i=this.$TextField;return i[1e3]=e,e+=this.$getWidth(),t.prototype.$setX.call(this,e)},e.prototype.$getX=function(){var t=this.$TextField;return t[1e3]=0,t[1e3]},e.prototype.$setScaleX=function(e){t.prototype.$setScaleX.call(this,-1*e)},e.prototype.$setTextAlign=function(e){var i=(n={},n[egret.HorizontalAlign.LEFT]=egret.HorizontalAlign.RIGHT,n[egret.HorizontalAlign.RIGHT]=egret.HorizontalAlign.LEFT,n);return e=i[e]||e,t.prototype.$setTextAlign.call(this,e);var n},e.prototype.$setText=function(e){var i=t.prototype.$setText.call(this,e);return i&&(this.x=this.$TextField[1e3]),i},e}(egret.TextField);__reflect(TextFieldArab.prototype,"TextFieldArab");var LoadingMeanEffect=function(t){function e(){var e=t.call(this)||this;return e._ttrArr=[],e._startTime=0,e._tempTime=0,e._frameSize=0,e._horizontalAlign=egret.HorizontalAlign.LEFT,e._verticalAlign=egret.VerticalAlign.TOP,e._preTime=0,e._loop=0,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.playing=!1,this._bmp=new egret.Bitmap,this._bmp.touchEnabled=!1,this.addChild(this._bmp)},e.prototype.textureData=function(t,e,i){void 0===e&&(e=100),void 0===i&&(i=0),t&&0!=t.length&&(this._ttrArr=t,this._interval=e,this._loop=i,this._frameSize=this._ttrArr.length,this._ttrArr.length>0&&(this.width=this._ttrArr[0].textureWidth,this.height=this._ttrArr[0].textureHeight))},e.prototype.play=function(t){void 0===t&&(t=0),this._startTime=egret.getTimer(),this._preTime=0,this._loop=t,this.playing=!0,LoadingManager.$stage.addEventListener(egret.Event.ENTER_FRAME,this.__enterFrameHandler,this)},e.prototype.stop=function(){this.playing=!1,LoadingManager.$stage.removeEventListener(egret.Event.ENTER_FRAME,this.__enterFrameHandler,this)},e.prototype.__enterFrameHandler=function(t){if(!(this._frameSize<=0)){this._tempTime=egret.getTimer();var e=this._tempTime-this._startTime;if(!(0>e||this._tempTime-this._preTime<this._interval))return this._preTime=this._tempTime,this._currFrame=Math.floor(e/this._interval),this._loop>0&&this._currFrame/this._frameSize>=this._loop?(this.stop(),void this.dispatchEventWith(egret.Event.COMPLETE)):void(this._bmp.texture=this._ttrArr[this._currFrame%this._frameSize])}},e.prototype.dispose=function(){this.stop(),this.alpha=1,this.parent&&this.parent.removeChild(this),this._bmp&&(this._bmp.texture=null,this._bmp.parent&&this._bmp.parent.removeChild(this._bmp),this._bmp=null),this._ttrArr&&(this._ttrArr.length=0),this._ttrArr=null},e}(eui.Component);__reflect(LoadingMeanEffect.prototype,"LoadingMeanEffect");var SelectRoleFrame=function(t){function e(){var e=t.call(this,"SelectRoleFrame")||this;return e.MAX_TIME=30,e.initName=!1,e}return __extends(e,t),e.prototype.createView=function(){this.width=540,this.top=0,this.bottom=0,this.horizontalCenter=0;var t=20;this.manBtn=new eui.Image,this.manBtn.horizontalCenter=-70,this.manBtn.bottom=t+230,this.addChild(this.manBtn),this.womanBtn=new eui.Image,this.womanBtn.horizontalCenter=70,this.womanBtn.bottom=t+230,this.addChild(this.womanBtn),this.nameBack=new eui.Image,this.nameBack.touchEnabled=!1,this.nameBack.source="selectrole_json.select_role_namebg_png",this.nameBack.width=399,this.nameBack.horizontalCenter=16,this.nameBack.bottom=t+150,this.addChild(this.nameBack),this.enterGameBtn=new eui.Button,this.enterGameBtn.skinName=this.getEnterGameBtnSkin(),this.enterGameBtn.width=395,this.enterGameBtn.height=34,this.enterGameBtn.horizontalCenter=0,this.enterGameBtn.bottom=t+65,this.addChild(this.enterGameBtn),this.nickNameTxt=new eui.EditableText,this.nickNameTxt.fontFamily="SimHei",this.nickNameTxt.maxChars=12,this.nickNameTxt.size=28,this.nickNameTxt.strokeColor=8292497,this.nickNameTxt.text="--",this.nickNameTxt.textAlign="center",this.nickNameTxt.textColor=16380887,this.nickNameTxt.width=250,this.nickNameTxt.height=28,this.nickNameTxt.horizontalCenter=0,this.nickNameTxt.bottom=t+170,this.addChild(this.nickNameTxt),this.randomBtn=new eui.Button,this.randomBtn.skinName=this.getRandomBtnSkin(),this.randomBtn.width=60,this.randomBtn.height=86,this.randomBtn.horizontalCenter=151,this.randomBtn.bottom=t+145,this.addChild(this.randomBtn),this.msgTxt=new eui.Label,this.msgTxt.fontFamily="SimHei",this.msgTxt.horizontalCenter=0,this.msgTxt.size=20,this.msgTxt.height=20,this.msgTxt.stroke=1,this.msgTxt.strokeColor=202275,this.msgTxt.text="",this.msgTxt.textColor=16321548,this.msgTxt.touchEnabled=!1,this.msgTxt.bottom=t+210,this.addChild(this.msgTxt),this.timeTxt=new eui.Label,this.timeTxt.fontFamily="SimHei",this.timeTxt.horizontalCenter=5,this.timeTxt.size=20,this.timeTxt.height=20,this.timeTxt.text="",this.timeTxt.stroke=1,this.timeTxt.strokeColor=68372,this.timeTxt.textColor=16380887,this.timeTxt.touchEnabled=!1,this.timeTxt.bottom=15,this.addChild(this.timeTxt),this.manRole=new LoadingBonesDisplay,this.manRole.stop(),this.manRole.x=0,this.manRole.y=300,this.manRole.scaleX=this.manRole.scaleY=.8,this.womanRole=new LoadingBonesDisplay,this.manRole.stop(),this.womanRole.x=0,this.womanRole.y=300,this.womanRole.scaleX=this.womanRole.scaleY=.8,this.bonesGroup=new eui.Group,this.bonesGroup.verticalCenter=0,this.bonesGroup.horizontalCenter=0,this.bonesGroup.touchEnabled=!1,this.bonesGroup.touchChildren=!1,this.addChildAt(this.bonesGroup,0),htgPlatSdk.searchExtraAction(LoadingConst.AGREEMENT_KEY)&&(this.agreementView=new AgreementView,this.agreementView.horizontalCenter=0,this.agreementView.bottom=t+20,this.addChild(this.agreementView))},e.prototype.getEnterGameBtnSkin=function(){var t=new eui.Skin;t.skinParts=["mcDisplay"];var e=new eui.Group;return e.touchChildren=!1,e.touchEnabled=!1,e.verticalCenter=0,e.horizontalCenter=0,t.mcDisplay=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("mcDisplay","scaleX",1),new eui.SetProperty("mcDisplay","scaleY",1)]),new eui.State("disabled",[])],t},e.prototype.getRandomBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="selectrole_json.select_role_random_png",e.anchorOffsetX=30,e.anchorOffsetY=43,e.x=30,e.y=43,t.backimg=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("backimg","scaleX",.96),new eui.SetProperty("backimg","scaleY",.96)]),new eui.State("disabled",[])],t},e.prototype.initView=function(){this.createView(),this.enterGameing=!1,this.countDown=0,this.btnMc=new LoadingMeanEffect;var t=[];t.push(RES.getRes("selectrole_json.select_role_enter_1_png")),t.push(RES.getRes("selectrole_json.select_role_enter_2_png")),t.push(RES.getRes("selectrole_json.select_role_enter_3_png")),t.push(RES.getRes("selectrole_json.select_role_enter_4_png")),t.push(RES.getRes("selectrole_json.select_role_enter_5_png")),t.push(RES.getRes("selectrole_json.select_role_enter_6_png")),this.btnMc.textureData(t),this.btnMc.play(),this.enterGameBtn.mcDisplay&&this.enterGameBtn.mcDisplay.addChild(this.btnMc),this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this._time=new egret.Timer(1e3),this.sound=new egret.Sound,this.sound.addEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this),this.sound.load(LoadingConst.getClickSound()),this.sound2=new egret.Sound,this.sound2.addEventListener(egret.Event.COMPLETE,this.__sound2CompleteHandler,this),this.sound2.load(LoadingConst.getClickSounds()),this.interval=0,this.angle=Math.PI/2},e.prototype.initEvent=function(){this.manBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__roleChangeHandler,this),this.womanBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__roleChangeHandler,this),this.randomBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__randomNameNickHandler,this),this.nickNameTxt.addEventListener(egret.FocusEvent.FOCUS_IN,this.__focusInTxtHandler,this),this.nickNameTxt.addEventListener(egret.FocusEvent.FOCUS_OUT,this.__focusOutTxtHandler,this),this.enterGameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__enterGameHandler,this),this.request.addEventListener(egret.Event.COMPLETE,this.__onCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__onIOErrorHandler,this),this._time.addEventListener(egret.TimerEvent.TIMER,this.__countDownHandler,this)},e.prototype.removeEvent=function(){this.manBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__roleChangeHandler,this),this.womanBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__roleChangeHandler,this),this.randomBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__randomNameNickHandler,this),this.nickNameTxt.removeEventListener(egret.FocusEvent.FOCUS_IN,this.__focusInTxtHandler,this),this.nickNameTxt.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.__focusOutTxtHandler,this),this.enterGameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__enterGameHandler,this),this._time.removeEventListener(egret.TimerEvent.TIMER,this.__countDownHandler,this)},e.prototype.initData=function(){var t=Math.ceil(2*Math.random());1==t?this.manBtn.dispatchEventWith(egret.TouchEvent.TOUCH_TAP):this.womanBtn.dispatchEventWith(egret.TouchEvent.TOUCH_TAP),this._time.start(),htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:12})},e.prototype.__roleChangeHandler=function(t){this.sound2Loaded&&this.sound2&&this.sound2.play(0,1),this.selectIndex=t.currentTarget==this.manBtn?0:1,this.bonesGroup.removeChildren(),0==this.selectIndex?(this.manRole.source=LoadingConst.res_path+LoadingConst.BONES_MAN,this.manRole.play(),this.womanRole.stop(),egret.Tween.get(this.manRole).to({alpha:1},200),egret.Tween.get(this.womanRole).to({alpha:0},200),this.manBtn.texture=RES.getRes("selectrole_json.select_role_man_2_png"),this.womanBtn.texture=RES.getRes("selectrole_json.select_role_wuman_1_png"),this.bonesGroup.addChild(this.manRole)):(this.womanRole.source=LoadingConst.res_path+LoadingConst.BONES_WOMAN,this.manRole.stop(),this.womanRole.play(),egret.Tween.get(this.manRole).to({alpha:0},200),egret.Tween.get(this.womanRole).to({alpha:1},200),this.manBtn.texture=RES.getRes("selectrole_json.select_role_man_1_png"),this.womanBtn.texture=RES.getRes("selectrole_json.select_role_wuman_2_png"),this.bonesGroup.addChild(this.womanRole)),this.__randomNameNickHandler(null),this.updateMsg(1e3)},e.prototype.__randomNameNickHandler=function(t){if(this.sound2Loaded&&this.sound2&&this.sound2.play(0,1),!this.enterGameing){if(!this.initName&&(this.initName=!0,LoadingManager.instance.name))return void(this.nickNameTxt.text=LoadingManager.instance.name);this.nickNameTxt.text=LoadingManager.instance.getNickNameBySex(this.selectIndex+1),this.updateMsg(1e3)}},e.prototype.__focusInTxtHandler=function(t){this.countDown=this.MAX_TIME,this.updateMsg(1e3)},e.prototype.__focusOutTxtHandler=function(t){this.resetCountDown()},e.prototype.__enterGameHandler=function(t){if(htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:106}),this.soundLoaded&&this.sound&&this.sound.play(0,1),!this.enterGameing){var e=this.nickNameTxt.text.trim();if(0==e.length)return this.updateMsg(1001),void this.resetCountDown();if(LoadingManager.isEmojiCharacter(e))return this.updateMsg(1002),void this.resetCountDown();var i=LoadingConst.getStringLength(e);if(4>i)return this.updateMsg(1003),void this.resetCountDown();if(i>30)return this.updateMsg(1004),void this.resetCountDown();if(this.agreementView&&!this.agreementView.selected)return LoadingAlert.show(LoadingConst.MSG_12,null,LoadingAlert.YES),void this.resetCountDown();this.setEntering(!0),this._currName=e,LoadingConst.checkState?this.__regNickName():htgPlatSdk.msgSecCheck(e,this.__nickCheckBack.bind(this))}},e.prototype.__nickCheckBack=function(t){return 0!=t?(this.updateMsg(4),this.resetCountDown(),void this.setEntering(!1)):void this.__regNickName()},e.prototype.__regNickName=function(){if(LoadingManager.instance.serverData){var t,e=LoadingManager.instance.serverData.id,i=LoadingManager.instance.openId,n=this.selectIndex+1,r=this._currName,s=LoadingManager.instance.loginData.s;t=LoadingManager.instance.serverData.an;var o=LoadingManager.instance.serverData.aid,a=s&&s.length>1?"1":"0",h=LoadingConst.getCreatRoleUrl(e,i,n,r,LoadingConst.ZONE_KEY,a,t,o),l=QQMiniShare.instance.shareOpenID,c=QQMiniShare.instance.shareUID;l!=i&&QQMiniShare.instance.checkSign()&&(h+="&shareUID="+c,console.log("绑定分享人信息：shareUID:",c,"shareOpenID:",l)),this.request.open(h,egret.HttpMethod.GET),this.request.send()}},e.prototype.__onCompleteHandler=function(t){var e=JSON.parse(this.request.response);if(e){var i=e.c||0;e.time||0;if(1!=i)this.updateMsg(i),this.resetCountDown(),this.setEntering(!1);else{LoadingManager.instance.uid=parseInt(e.u),LoadingManager.instance.loginKey=e.k,LoadingManager.instance.chatKey=e.chatkey,LoadingManager.instance.ip=e.cip,LoadingManager.instance.port=e.cpt,LoadingManager.instance.isNew=!0,LoginBackView.instance.show(1),LoadingManager.instance.enterGame();var n=e.reportdata;n&&(LoadingConst.IS_REPORT_SELECT_SER||(htgPlatSdk.gameReport(LoadingConst.REGISTER_REPORT,n),LoadingConst.IS_REPORT_SELECT_SER=!0),htgPlatSdk.gameReport(LoadingConst.CREATE_REPORT,n),htgPlatSdk.eventReport({key:EventReportType.create_role_success,token:"",type:"",paramData:n})),this.dispose()}}},e.prototype.__countDownHandler=function(){if(!(this.enterGameing||this.countDown>=this.MAX_TIME)){if(PlatformSnKey.isGaore())return void(this.timeTxt.text="");this.countDown++,this.timeTxt.text=LoadingConst.MSG_6.replace("{}",(this.MAX_TIME-this.countDown).toString()),this.countDown>=this.MAX_TIME&&this.__enterGameHandler(null)}},e.prototype.__enterFrameHandler=function(t){this.enterGameBtn&&(egret.getTimer()-this.interval<50||(this.interval=egret.getTimer(),this.enterGameBtn.alpha=.6+.4*Math.sin(this.angle),this.angle+=.1))},e.prototype.resetCountDown=function(){this.countDown=0},e.prototype.__onIOErrorHandler=function(t){this.updateMsg(5),this.resetCountDown(),this.setEntering(!1)},e.prototype.updateMsg=function(t){void 0===t&&(t=1e3),this.msgTxt.text=LoadingManager.instance.getMsgPrompt(t)},e.prototype.setEntering=function(t){this.enterGameing=t,this.manBtn.touchEnabled=this.womanBtn.touchEnabled=!t},e.prototype.show=function(){this.alpha=0,egret.Tween.get(this).to({alpha:1},1e3),LoadingLayer.instance.addToLayer(this)},e.prototype.__soundCompleteHandler=function(t){this.soundLoaded=!0},e.prototype.__sound2CompleteHandler=function(t){this.sound2Loaded=!0},e.prototype.dispose=function(){this.destory||(this.removeEvent(),egret.Tween.removeTweens(this.manRole),egret.Tween.removeTweens(this.womanRole),egret.Tween.removeTweens(this),this.manRole&&this.manRole.stop(),LoadingConst.disposeObject(this.manRole),this.manRole=null,this.womanRole&&this.womanRole.stop(),LoadingConst.disposeObject(this.womanRole),this.womanRole=null,LoadingConst.disposeObject(this.enterGameBtn),this.enterGameBtn=null,LoadingConst.disposeObject(this.nickNameTxt),this.nickNameTxt=null,LoadingConst.disposeObject(this.manBtn),this.manBtn=null,LoadingConst.disposeObject(this.womanBtn),this.womanBtn=null,LoadingConst.disposeObject(this.randomBtn),this.randomBtn=null,LoadingConst.disposeObject(this.msgTxt),this.msgTxt=null,LoadingConst.disposeObject(this.nameBack),this.nameBack=null,LoadingConst.disposeObject(this.timeTxt),this.timeTxt=null,LoadingConst.disposeObject(this.bonesGroup),this.bonesGroup=null,this.request&&(this.request.removeEventListener(egret.Event.COMPLETE,this.__onCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onIOErrorHandler,this)),this.request=null,this._time=null,this.bgSoundHandler&&this.bgSoundHandler.stop(),LoadingConst.disposeObject(this.btnMc),this.btnMc=null,LoadingConst.disposeObject(this.bgSoundHandler),this.bgSoundHandler=null,LoadingConst.disposeObject(this.sound),this.sound=null,LoadingConst.disposeObject(this.soundLoaded),this.soundLoaded=null,LoadingConst.disposeObject(this.sound2),this.sound2=null,LoadingConst.disposeObject(this.sound2Loaded),this.sound2Loaded=null,LoadingConst.disposeObject(this.agreementView),this.agreementView=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(SelectRoleFrame.prototype,"SelectRoleFrame");var ChangeServerFrame=function(t){function e(e){var i=t.call(this,"ChangeServerFrame")||this;return i.historyServers=e||[],i}return __extends(e,t),e.prototype.createView=function(){this.width=488,this.height=762,this.verticalCenter=0,this.horizontalCenter=0,this.titleImg=new eui.Image,this.titleImg.source="loading_json.alert_back_png",this.titleImg.touchEnabled=!1,this.titleImg.scale9Grid=new egret.Rectangle(173,9,103,18),this.titleImg.width=502,this.addChild(this.titleImg),this.backImg=new eui.Image,this.backImg.source="loading_json.alert_back_2_png",this.backImg.scale9Grid=new egret.Rectangle(12,32,18,195),this.backImg.height=709,this.backImg.width=500,this.backImg.y=34,this.backImg.x=0,this.backImg.touchEnabled=!1,this.addChild(this.backImg),this.rectImg=new eui.Image,this.rectImg.source="loading_json.alert_borderbg_png",this.rectImg.scale9Grid=new egret.Rectangle(15,15,6,5),this.rectImg.height=683,this.rectImg.width=311,this.rectImg.y=41,this.rectImg.x=178,this.rectImg.touchEnabled=!1,this.addChild(this.rectImg),this.descTxt=new eui.Label,this.descTxt.size=20,this.descTxt.fontFamily="SimHei",this.descTxt.textAlign="center",this.descTxt.touchEnabled=!1,this.descTxt.textColor=16250612,this.descTxt.width=150,this.descTxt.height=20,this.descTxt.x=260,this.descTxt.y=350,this.addChild(this.descTxt),this.titleLab=new eui.Label,this.titleLab.size=22,this.titleLab.fontFamily="SimHei",this.titleLab.textAlign="center",this.titleLab.touchEnabled=!1,this.titleLab.textColor=16380887,this.titleLab.width=120,this.titleLab.height=22,this.titleLab.horizontalCenter=15,this.titleLab.y=5,this.addChild(this.titleLab),this.groupScroller=new eui.Scroller,this.groupScroller.anchorOffsetX=0,this.groupScroller.anchorOffsetY=0,this.groupScroller.width=150,this.groupScroller.height=680,this.groupScroller.x=15,this.groupScroller.y=46,this.groupScroller.viewport=this.serverGroupList=this.getGroupViewPort(3),this.addChild(this.groupScroller),this.listScroller=new eui.Scroller,this.listScroller.anchorOffsetX=0,this.listScroller.anchorOffsetY=0,this.listScroller.width=282,this.listScroller.height=670,this.listScroller.x=192,this.listScroller.y=48,this.listScroller.viewport=this.serverList=this.getGroupViewPort(3),this.addChild(this.listScroller),this.closeBtn=new eui.Button,this.closeBtn.skinName=this.getCloseBtnSkin(),this.closeBtn.x=459,this.closeBtn.y=-18,this.addChild(this.closeBtn)},e.prototype.getCloseBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="loading_json.alert_close_png",t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2)]),new eui.State("disabled",[])],t},e.prototype.getGroupViewPort=function(t){var e=new eui.List;return e.anchorOffsetX=0,e.anchorOffsetY=0,e.percentHeight=100,e.useVirtualLayout=!0,e.percentWidth=100,e.layout=this._VerticalLayout1_i(t),e},e.prototype._VerticalLayout1_i=function(t){var e=new eui.VerticalLayout;return e.gap=t,e.horizontalAlign="left",e.verticalAlign="top",e},e.prototype.initView=function(){this.createView(),this.errorCount=0,this.descTxt.text=LoadingConst.MSG_3,this.titleLab.text=LoadingConst.MSG_4,this.groupData=new eui.ArrayCollection,this.serverGroupList.dataProvider=this.groupData,this.serverGroupList.itemRenderer=ChangeServerItem,this.listData=new eui.ArrayCollection,this.serverList.dataProvider=this.listData,this.serverList.itemRenderer=ServerItemRenderer,this.groupData.source.push({history:!0}),this.groupData.refresh()},e.prototype.initEvent=function(){this.closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeFrameHandler,this),this.serverGroupList.addEventListener(egret.Event.CHANGE,this.__serverGroupChangeHandler,this),this.serverList.addEventListener(egret.Event.CHANGE,this.__serverChangeHandler,this)},e.prototype.removeEvent=function(){this.closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__closeFrameHandler,this),this.serverGroupList.removeEventListener(egret.Event.CHANGE,this.__serverGroupChangeHandler,this),this.serverList.removeEventListener(egret.Event.CHANGE,this.__serverChangeHandler,this)},e.prototype.initData=function(){this.selectedHistory();var t=LoadingConst.getAllServerListUrl(LoadingManager.instance.openId,LoadingConst.ZONE_KEY);this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.open(t,egret.HttpMethod.GET),this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.request.addEventListener(egret.Event.COMPLETE,this.__onGetCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__onGetIOErrorHandler,this),this.request.send()},e.prototype.selectedHistory=function(){this.historyServers&&0!=this.serverGroupList.selectedIndex&&(this.serverGroupList.selectedIndex=0,this.__serverGroupChangeHandler(null))},e.prototype.__onGetCompleteHandler=function(t){var e;try{this.allServerList=JSON.parse(this.request.response)}catch(t){}finally{e=this.allServerList&&this.allServerList.length||0}if(e>0){e>1&&this.allServerList.sort(this.serverSoft);for(var i=Math.ceil(e/100),n=void 0,r=[],s=0;i>s;s++)n={},n.si=100*s+1,n.ei=n.si+99,r.push(n);r.push({history:!0}),r.length>0&&r.reverse(),this.groupData.replaceAll(r)}else this.__onGetIOErrorHandler(null)},e.prototype.serverSoft=function(t,e){return t.aid<e.aid?-1:1},e.prototype.__onGetIOErrorHandler=function(t){this.errorCount++,this.errorCount<3?(this.request.open(LoadingConst.getAllServerListUrl(LoadingManager.instance.openId,LoadingConst.ZONE_KEY),egret.HttpMethod.GET),this.request.send()):LoadingAlert.show(LoadingConst.GET_ERROR,void 0,LoadingAlert.YES)},e.prototype.__serverGroupChangeHandler=function(t){this.listScroller&&this.listScroller.stopAnimation();var e=this.serverGroupList.selectedItem;this.listData.source.length=0;var i,n=[];if(e.history)for(var r=0;r<this.historyServers.length;r++)i=this.historyServers[r],i&&-1==n.indexOf(i.id)&&(n.push(i.id),this.listData.source.push(i));else{for(var r=e.si;r<=e.ei;r++)i=this.allServerList[r-1],i&&-1==n.indexOf(i.id)&&(n.push(i.id),this.listData.source.push(i));this.listData.source.reverse()}this.listData.refresh(),this.descTxt.visible=!(this.listData.length>0)},e.prototype.__serverChangeHandler=function(t){var e=this.serverList.selectedIndex;if(e>=0&&e<this.listData.length){var i=this.listData.source[e];this._callFun&&this._callFun.call(this._thisObj,i),this.__closeFrameHandler(null)}},e.prototype.show=function(t,e){this._callFun=t,this._thisObj=e,this.visible=!0,this.selectedHistory(),!this.parent&&LoadingLayer.instance.addToLayer(this)},e.prototype.hide=function(){this.visible=!1},e.prototype.__closeFrameHandler=function(t){this.serverList.selectedIndex=-1,this.hide()},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.titleImg),this.titleImg=null,LoadingConst.disposeObject(this.closeBtn),this.closeBtn=null,LoadingConst.disposeObject(this.descTxt),this.descTxt=null,LoadingConst.disposeObject(this.titleLab),this.titleLab=null,LoadingConst.disposeObject(this.backImg),this.backImg=null,LoadingConst.disposeObject(this.rectImg),this.rectImg=null,this.groupScroller&&(this.groupScroller.stopAnimation(),this.groupScroller.viewport=null,LoadingConst.disposeObject(this.groupScroller)),this.groupScroller=null,this.serverGroupList&&(this.serverGroupList.dataProvider=null,LoadingConst.disposeObject(this.serverGroupList)),this.serverGroupList=null,this.listScroller&&(this.listScroller.stopAnimation(),this.listScroller.viewport=null,LoadingConst.disposeObject(this.listScroller)),this.listScroller=null,this.serverList&&(this.serverList.dataProvider=null,LoadingConst.disposeObject(this.serverList)),this.serverList=null,this.request&&(this.request.removeEventListener(egret.Event.COMPLETE,this.__onGetCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onGetIOErrorHandler,this)),this.request=null,this.historyServers=null,this.groupData=null,this.listData=null,this._callFun=null,this._thisObj=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(ChangeServerFrame.prototype,"ChangeServerFrame");var ChangeServerItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=e.getSelfSkins(),e}return __extends(e,t),e.prototype.getSelfSkins=function(){var t=new eui.Skin;t.width=150,t.height=50,t.skinParts=["backImg","nameTxt"];var e=new eui.Image;e.touchEnabled=!1,e.source="selectserver_json.change_server_back3_png",e.x=e.y=0,t.backImg=e;var i=new eui.Label;return i.size=20,i.fontFamily="SimHei",i.textColor=12642298,i.textAlign="center",i.touchEnabled=!1,i.width=150,i.height=20,i.x=6,i.verticalCenter=0,i.horizontalCenter=0,t.nameTxt=i,t.elementsContent=[e,i],t.states=[new eui.State("up",[]),new eui.State("down",[]),new eui.State("upAndSelected",[new eui.SetProperty("backImg","source","selectserver_json.change_server_back2_png"),new eui.SetProperty("nameTxt","textColor",739972)]),new eui.State("downAndSelected",[new eui.SetProperty("backImg","source","selectserver_json.change_server_back2_png"),new eui.SetProperty("nameTxt","textColor",739972)])],t},e.prototype.initEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removedFromStageHandler,this)},e.prototype.removeEvent=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removedFromStageHandler,this)},e.prototype.initData=function(){this.dataChanged()},e.prototype.dataChanged=function(){this.initFinish&&this.data&&(this.groupInfo=this.data,this.groupInfo.history?this.nameTxt.text=LoadingConst.HISTORY_SERVER:this.nameTxt.text=LoadingConst.SERVER+this.groupInfo.si+"-"+this.groupInfo.ei)},e.prototype.__removedFromStageHandler=function(t){this.dispose()},e.prototype.dispose=function(){this.destory||(this.removeEvent(),this.nameTxt.parent&&this.nameTxt.parent.removeChild(this.nameTxt),this.nameTxt=null,this.groupInfo=null,t.prototype.dispose.call(this))},e}(LoadingBaseItemRenderer);__reflect(ChangeServerItem.prototype,"ChangeServerItem");var LoadingFrame=function(t){function e(){var i=t.call(this,"LoadingFrame")||this;return i.progs=[{i:30,s:1},{i:45,s:1},{i:60,s:1},{i:80,s:1}],e._instance?i:(e._instance=i,i)}return __extends(e,t),e.prototype.createView=function(){this.width=540,this.height=960,this.touchEnabled=!1,this.horizontalCenter=0,this.top=0,this.bottom=0;var t=150;this.totalProBg=new eui.Image,this.totalProBg.horizontalCenter=0,this.totalProBg.bottom=t+30,this.addChild(this.totalProBg),this.currProBg=new eui.Image,this.currProBg.horizontalCenter=0,this.currProBg.bottom=t,this.addChild(this.currProBg),this.msgTxt=new eui.Label,this.msgTxt.size=16,this.msgTxt.fontFamily="SimHei",this.msgTxt.textColor=16380887,this.msgTxt.textAlign="center",this.msgTxt.width=300,this.msgTxt.height=16,this.msgTxt.horizontalCenter=0,this.msgTxt.bottom=117,this.addChild(this.msgTxt),this.totalProg_img=new eui.Image,this.totalProg_img.width=546,this.totalProg_img.horizontalCenter=0,this.totalProg_img.bottom=t-1,this.addChild(this.totalProg_img),this.currProg_img=new eui.Image,this.currProg_img.width=546,this.currProg_img.horizontalCenter=0,this.currProg_img.bottom=t+29,this.addChild(this.currProg_img),this.total_run=new eui.Image,this.total_run.bottom=t-5,this.addChild(this.total_run),this.curr_run=new eui.Image,this.curr_run.bottom=t+25,this.addChild(this.curr_run),this.splitImg=new eui.Rect(540,1,16380887),this.splitImg.touchEnabled=this.splitImg.touchChildren=!1,this.splitImg.bottom=80,this.splitImg.fillAlpha=.3,this.addChild(this.splitImg),this.infoTxt=new eui.Label,this.infoTxt.size=16,this.infoTxt.lineSpacing=10,this.infoTxt.fontFamily="SimHei",this.infoTxt.textColor=16380887,this.infoTxt.textAlign="center",this.infoTxt.width=540,this.infoTxt.height=64,this.infoTxt.horizontalCenter=0,this.infoTxt.bottom=0,this.addChild(this.infoTxt),this.proLab=new eui.Label,this.proLab.size=16,this.proLab.fontFamily="SimHei",this.proLab.textColor=16380887,this.proLab.textAlign="center",this.proLab.width=500,this.proLab.height=16,this.proLab.horizontalCenter=0,this.proLab.bottom=91,this.addChild(this.proLab),this.ageBtn=new eui.Button,this.ageBtn.skinName=this.getageBtnSkin(),this.ageBtn.right=20,this.ageBtn.top=50,LoadingConst.isIosNativeDebug()||this.addChild(this.ageBtn)
},e.prototype.initView=function(){this.createView(),this.msgTxt.text=LoadingConst.MSG_1,this.infoTxt.text=LoadingConst.MSG_7;var t=RES.getRes("loading_json.loading_prog_back_png");this.totalProBg.texture=t,this.currProBg.texture=t,t=RES.getRes("loading_json.loading_prog_png"),this.totalProg_img.texture=t,this.currProg_img.texture=t,t=RES.getRes("loading_json.loading_lotus_png"),this.total_run.texture=t,this.curr_run.texture=t,LoadingConst.iosHideProgress()&&(this.totalProBg.visible=!1,this.currProBg.visible=!1,this.msgTxt.visible=!1,this.total_run.visible=!1,this.curr_run.visible=!1,this.totalProg_img.visible=!1,this.currProg_img.visible=!1)},e.prototype.removeEvent=function(){this.proLab.removeEventListener(egret.TextEvent.LINK,this.__linkHandler,this),LoadingManager.$stage.removeEventListener(egret.Event.ENTER_FRAME,this.__enterFrameHandler,this)},e.prototype.initData=function(){},Object.defineProperty(e,"instance",{get:function(){return this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.setup=function(){this.loopFrame=0,this._currProg=0,this._totalProg=0,this.showSkillCard(),this.updateProgBar(this._currProg),LoadingManager.$stage.addEventListener(egret.Event.ENTER_FRAME,this.__enterFrameHandler,this),!this.parent&&LoadingLayer.instance.addToLayer(this)},e.prototype.showSkillCard=function(){LoadingManager.instance.isNew&&(this.step=1,this.reward1=new eui.Image,this.reward1.source="selectrole_json.select_role_s_0_png",this.reward1.x=100,this.reward2=new eui.Image,this.reward2.source="selectrole_json.select_role_s_1_png",this.reward2.x=200,this.reward3=new eui.Image,this.reward3.source="selectrole_json.select_role_s_2_png",this.reward3.x=300,this.reward4=new eui.Image,this.reward4.source="selectrole_json.select_role_s_3_png",this.reward4.x=400,this.rewardTitle=new eui.Image,this.rewardTitle.source="selectrole_json.select_title_png",this.rewardTitle.horizontalCenter=-20,this.rewardTitle.bottom=300,this.addChild(this.rewardTitle),this.group=new eui.Group,this.group.height=90,this.group.width=488,this.group.x=-23,this.group.bottom=210,this.group.addChild(this.reward1),this.group.addChild(this.reward2),this.group.addChild(this.reward3),this.group.addChild(this.reward4),this.group.touchChildren=!1,this.addChild(this.group))},e.prototype.getageBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new eui.Image;return e.touchEnabled=!1,e.source="selectserver_json.selectserver_age_png",e.x=40,e.y=51,e.anchorOffsetX=40,e.anchorOffsetY=51,e.scaleX=1,e.scaleY=1,t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","scaleX",1),new eui.SetProperty("img_1","scaleY",1)]),new eui.State("disabled",[])],t},e.prototype.pause=function(){LoadingManager.$stage.removeEventListener(egret.Event.ENTER_FRAME,this.__enterFrameHandler,this),this.parent&&this.parent.removeChild(this)},e.prototype.load=function(t,e,i,n){t&&0!=t.length&&(this.items=t,this.callFun=e,this.thisObj=i,this.params=n,this.proLab.addEventListener(egret.TextEvent.LINK,this.__linkHandler,this),this.currIndex=-1,this.currData=null,this.intStep=this._totalProg,this.stepProg=parseFloat(((100-this._totalProg)/this.items.length).toFixed(1)),this.loadNext())},e.prototype.__linkHandler=function(){window.location.reload()},e.prototype.loadNext=function(){return this.currIndex++,this.currIndex>=this.items.length?void egret.Tween.get(this).wait(300).call(this.__loadOverHandler,this):(this._currProg=this._totalProg,this.totalProg=this.intStep+this.currIndex*this.stepProg,this.currData=this.items[this.currIndex],void(2==this.currData.type&&PreLoadManager.instance.loadProgress(this.__progressHandler,this)))},e.prototype.__progressHandler=function(t){this._totalProg=t,this._totalProg>=100&&(PreLoadManager.instance.loadProgress(null,null),this.loadNext())},e.prototype.__loadOverHandler=function(){egret.Tween.removeTweens(this);var t=this.callFun,e=this.thisObj,i=this.params;t&&t.apply(e,i)},e.prototype.__enterFrameHandler=function(){this.initFinish&&!this.destory&&(this.loopFrame++,this.updateTotalProg(),this.updateFalseProg(),this.updateCardImg())},e.prototype.updateTotalProg=function(){this.loopFrame%2==0&&this._currProg<100&&(this._currProg+=Math.max(.01,.05*(this._totalProg-this._currProg)),this._currProg=Math.min(100,this._currProg),this.updateProgBar(this._currProg));var t=LoadingConst.MSG_5,e=/{}/gi;t=t.replace(e,Math.floor(this._currProg)+""),this.proLab.textFlow=LoadingConst.getHtmlFlow(t)},e.prototype.updateProgBar=function(t){if(this.currProg_img){t=Math.floor(this.currProg_img.width*t*.01);var e=this.currProg_img.$scrollRect||new egret.Rectangle(0,0,0,0);e.setTo(0,0,t,this.currProg_img.height),this.currProg_img.scrollRect=e,this.curr_run.x=e.width-12}},e.prototype.updateFalseProg=function(){this.loopFrame>=100&&(this.loopFrame=0);var t=Math.floor(this.totalProg_img.width*this.loopFrame*.01),e=this.totalProg_img.$scrollRect||new egret.Rectangle(0,0,0,0);e.setTo(0,0,t,this.totalProg_img.height),this.totalProg_img.scrollRect=e,this.total_run.x=e.width-12},e.prototype.updateCardImg=function(){if(LoadingManager.instance.isNew)for(var t,e,i=0;4>i;i++)e=this.progs[i],this._currProg>=e.i&&(t=this.group.getChildAt(i),t&&(t.y+=e.s,t.y>5&&(e.s=-1),t.y<0&&(e.s=1)))},Object.defineProperty(e.prototype,"currProg",{get:function(){return this._currProg},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalProg",{set:function(t){0>t&&(t=0),t>100&&(t=100),this._totalProg=Math.floor(t)},enumerable:!0,configurable:!0}),e.prototype.__ageBtnHandler=function(){var t=new AgeTipsPop;t.show()},e.prototype.dispose=function(){this.destory||(this.removeEvent(),egret.Tween.removeTweens(this),this.items=null,this.callFun=null,this.thisObj=null,this.params=null,LoadingConst.disposeObject(this.totalProBg),this.totalProBg=null,LoadingConst.disposeObject(this.msgTxt),this.msgTxt=null,LoadingConst.disposeObject(this.totalProg_img),this.totalProg_img=null,LoadingConst.disposeObject(this.currProg_img),this.currProg_img=null,LoadingConst.disposeObject(this.total_run),this.total_run=null,LoadingConst.disposeObject(this.curr_run),this.curr_run=null,LoadingConst.disposeObject(this.proLab),this.proLab=null,LoadingConst.disposeObject(this.infoTxt),this.infoTxt=null,LoadingConst.disposeObject(this.splitImg),this.splitImg=null,LoadingConst.disposeObject(this.currProBg),this.currProBg=null,LoadingConst.disposeObject(this.group),this.group=null,LoadingConst.disposeObject(this.rewardTitle),this.rewardTitle=null,LoadingConst.disposeObject(this.ageBtn),this.ageBtn=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(LoadingFrame.prototype,"LoadingFrame");var LoginBackView=function(t){function e(){var i=this;if(!e._instance)return i=t.call(this,"LoginBackView")||this,e._instance=i,i}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||new e},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this.type=1,this.top=0,this.horizontalCenter=0,this.touchEnabled=!1,this.backImg=new eui.Image,this.backImg.percentWidth=100,this.backImg.percentHeight=100,this.addChildAt(this.backImg,0),this.switchAccBtn=new eui.Button,this.switchAccBtn.horizontalCenter=-256,this.switchAccBtn.top=135,this.addChild(this.switchAccBtn),this.switchAccBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__switchAccBtnClickHandler,this),this.fbBtn=new eui.Button,this.fbBtn.horizontalCenter=-265,this.fbBtn.top=210,this.addChild(this.fbBtn),this.fbBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__fbBtnClickHandler,this),this.fbBtn.visible=LoadingConst.IS_NATIVE,this.startLoadBack(),this.__resizeHandler(null)},e.prototype.initEvent=function(){LoadingManager.$stage.addEventListener(egret.Event.RESIZE,this.__resizeHandler,this)},e.prototype.removeEvent=function(){LoadingManager.$stage.removeEventListener(egret.Event.RESIZE,this.__resizeHandler,this)},e.prototype.initLoadBack=function(){this._initLoadBack||(this._initLoadBack=!0,this.startLoadBack())},e.prototype.startLoadBack=function(){var t=PlatformSnKey.changeLoginBack(LoadingConst.SN_KEY),e=".jpg",i=htgPlatSdk.getWebVer();t>0&&(i="_"+t+i);var n=LoadingConst.res_path+LoadingConst.LOADING_BACK_URL+i+e;LoadingConst.IS_MOBILE||(n=LoadingConst.res_path+LoadingConst.LOADING_BACK_PC+i+e),this._imageLoader=new egret.ImageLoader,this._imageLoader.addEventListener(egret.Event.COMPLETE,this.__onLoadFinishHandler,this),this._imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__onLoadErrorHandler,this),this._imageLoader.load(n)},e.prototype.__onLoadFinishHandler=function(t){if(!this.destory&&t.$type==egret.Event.COMPLETE){this.sel_serv_tex=new egret.Texture;var e=this._imageLoader.data;if(!e)return;this.sel_serv_tex.$bitmapData=e;var i=this._imageLoader.data.width,n=this._imageLoader.data.height;this.sel_serv_tex.$initData(0,0,i,n,0,0,i,n,i,n),1==this.type&&(this.backImg.source=this.sel_serv_tex)}},e.prototype.__onLoadErrorHandler=function(t){},e.prototype.__switchAccBtnClickHandler=function(){"function"==typeof htgPlatSdk.openUserCenter&&htgPlatSdk.openUserCenter()},e.prototype.__fbBtnClickHandler=function(){"function"==typeof htgPlatSdk.openFbShare&&htgPlatSdk.openFbShare()},e.prototype.getBtnSkin=function(t){var e=new eui.Skin;e.skinParts=[];var i=new egret.Bitmap;return i.touchEnabled=!1,i.texture=RES.getRes(t),e.img_1=i,e.elementsContent=[i],e.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2),new eui.SetProperty("mcDisplay","y",-2)]),new eui.State("disabled",[])],e},e.prototype.__resizeHandler=function(t){var e=LoadingManager.$stage.stageWidth,i=LoadingManager.$stage.stageHeight,n=LoadingConst.IS_MOBILE?740:1920,r=LoadingConst.IS_MOBILE?960:1080,s=n/e,o=r/i,a=Math.min(s,o);this.width=n/a,this.height=r/a},e.prototype.show=function(t){this.type=t||1,1==this.type?this.showSelectServerBack():2==this.type?this.showSelectRoleBack():3==this.type&&(this.switchAccBtn.skinName=this.getBtnSkin("loading_json.switch_account_btn_png"),this.fbBtn.skinName=this.getBtnSkin("loading_json.fb_btn_png")),this.switchAccBtn&&(this.switchAccBtn.visible=LoadingConst.IS_NATIVE&&"hw103"!=LoadingConst.SN_KEY)},e.prototype.showSelectServerBack=function(){this.backImg&&this.sel_serv_tex&&(this.backImg.source=this.sel_serv_tex)},e.prototype.showSelectRoleBack=function(){var t="select_role_back_pc_jpg";LoadingConst.IS_MOBILE&&(t="select_role_back_jpg"),this.backImg&&(this.backImg.source=t)},e.prototype.dispose=function(){e._instance=null,this.removeEvent(),this._imageLoader&&(this._imageLoader.removeEventListener(egret.Event.COMPLETE,this.__onLoadFinishHandler,this),this._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__onLoadErrorHandler,this)),this._imageLoader=null,this.switchAccBtn&&this.switchAccBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__switchAccBtnClickHandler,this),this.fbBtn&&this.fbBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__fbBtnClickHandler,this),LoadingConst.disposeObject(this.backImg),this.backImg=null,t.prototype.dispose.call(this)},e}(LoadingBaseUI);__reflect(LoginBackView.prototype,"LoginBackView");var SelectServerFrame=function(t){function e(){return t.call(this,"SelectServerFrame")||this}return __extends(e,t),e.prototype.createView=function(){this.width=540,this.height=960,this.horizontalCenter=0,this.top=0,this.bottom=0;var t=0;this.startGameBtn=new eui.Button,this.startGameBtn.skinName=this.getStartGameBtnSkin(),this.startGameBtn.width=395,this.startGameBtn.height=34,this.startGameBtn.horizontalCenter=0,this.startGameBtn.bottom=t+145,this.addChild(this.startGameBtn),this.changeServerImg=new eui.Image,this.changeServerImg.touchEnabled=!0,this.changeServerImg.texture=RES.getRes("selectserver_json.selectserver_back2_png"),this.changeServerImg.horizontalCenter=0,this.changeServerImg.bottom=t+240,this.addChild(this.changeServerImg),this.noticeBtn=new eui.Button,this.noticeBtn.skinName=this.getNoticeBtnSkin(),this.noticeBtn.width=58,this.noticeBtn.height=65,this.noticeBtn.left=26,this.noticeBtn.top=60,this.addChild(this.noticeBtn),this.clickChangeImg=new eui.Image,this.clickChangeImg.texture=RES.getRes("selectserver_json.change_server_png"),this.clickChangeImg.touchEnabled=!1,this.clickChangeImg.horizontalCenter=130,this.clickChangeImg.bottom=t+248,this.addChild(this.clickChangeImg),this.hotImg=new eui.Image,this.hotImg.touchEnabled=!1,this.hotImg.horizontalCenter=-140,this.hotImg.bottom=t+250,this.addChild(this.hotImg),this.serverIdTxt=new eui.Label,this.serverIdTxt.size=22,this.serverIdTxt.fontFamily="SimHei",this.serverIdTxt.touchEnabled=!1,this.serverIdTxt.textColor=16380887,this.serverIdTxt.height=22,this.serverIdTxt.horizontalCenter=-17,this.serverIdTxt.bottom=t+250,this.addChild(this.serverIdTxt),this.versionTxt=new eui.Label,this.versionTxt.size=16,this.versionTxt.fontFamily="SimHei",this.versionTxt.touchEnabled=!1,this.versionTxt.textColor=16380887,this.versionTxt.strokeColor=68372,this.versionTxt.stroke=1,this.versionTxt.width=540,this.versionTxt.height=100,this.versionTxt.x=5,this.versionTxt.top=5,this.addChild(this.versionTxt),LoadingConst.IS_MINI_GAME&&(this.repairBtn=new eui.Button,this.repairBtn.skinName=this.getRepairBtnSkin(),this.repairBtn.width=58,this.repairBtn.height=65,this.repairBtn.left=10,this.repairBtn.top=140,this.addChild(this.repairBtn)),htgPlatSdk.searchExtraAction(LoadingConst.AGREEMENT_KEY)&&(this.agreementView=new AgreementView,this.agreementView.horizontalCenter=0,this.agreementView.bottom=t+100,this.addChild(this.agreementView))},e.prototype.getStartGameBtnSkin=function(){var t=new eui.Skin;t.skinParts=["mcDisplay"];var e=new eui.Group;return e.touchChildren=!1,e.touchEnabled=!1,e.verticalCenter=0,e.horizontalCenter=0,t.mcDisplay=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("mcDisplay","scaleX",1),new eui.SetProperty("mcDisplay","scaleY",1)]),new eui.State("disabled",[])],t},e.prototype.breatheTween=function(t){egret.Tween.get(t).to({aplha:0},1e3).to({alpha:.8},1e3).call(this.breatheTween,this,[t])},e.prototype.getRepairBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new egret.Bitmap;return e.touchEnabled=!1,e.texture=RES.getRes("selectserver_json.selectserver_repair_png"),t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2),new eui.SetProperty("mcDisplay","y",-2)]),new eui.State("disabled",[])],t},e.prototype.getNoticeBtnSkin=function(){var t=new eui.Skin;t.skinParts=[];var e=new egret.Bitmap;return e.touchEnabled=!1,e.texture=RES.getRes("selectserver_json.selectserver_notice_png"),t.img_1=e,t.elementsContent=[e],t.states=[new eui.State("up",[]),new eui.State("down",[new eui.SetProperty("img_1","y",-2),new eui.SetProperty("mcDisplay","y",-2)]),new eui.State("disabled",[])],t},e.prototype.initView=function(){this.createView(),this.enterGameing=!1,this.versionTxt.text=LoadingConst.VERSION+htgPlatSdk.RES_TIMESTAMP,(LoadingConst.IS_QQ_MINI||LoadingConst.IS_WX_MINI)&&(this.versionTxt.text+=htgPlatSdk.getWebVer()),this.serverIdTxt.text=LoadingConst.SELECT_SERVER_TIP,this.btnMc=new LoadingMeanEffect;var t=[];if(t.push(RES.getRes("selectserver_start_1_png")),t.push(RES.getRes("selectserver_start_2_png")),t.push(RES.getRes("selectserver_start_3_png")),t.push(RES.getRes("selectserver_start_4_png")),t.push(RES.getRes("selectserver_start_5_png")),this.btnMc.textureData(t),this.btnMc.play(),this.startGameBtn.mcDisplay&&this.startGameBtn.mcDisplay.addChild(this.btnMc),LoadingConst.DEBUG){var e=LoadingManager.$stage.stageWidth,i=LoadingManager.$stage.stageHeight;LoadingManager.$stage.scaleMode;this.versionTxt.appendText("\nstageWidth:"+e+" stageHeight:"+i),this.versionTxt.appendText("\ntexture:"+LoadingConst.TEXTURE_COMPRESSED),this.versionTxt.appendText("\nismobile:"+LoadingConst.IS_MOBILE)}this.sound=new egret.Sound,this.sound.addEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this),this.sound.load(LoadingConst.getClickSound()),this.interval=0,this.angle=Math.PI/2},e.prototype.initEvent=function(){this.startGameBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__startGameHandler,this),this.changeServerImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__changeServerHandkler,this),this.noticeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__noticeBtnHandler,this),this.repairBtn&&this.repairBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.__clearCacheHandler,this)},e.prototype.removeEvent=function(){this.startGameBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__startGameHandler,this),this.changeServerImg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__changeServerHandkler,this),this.noticeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__noticeBtnHandler,this),this.repairBtn&&this.repairBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.__clearCacheHandler,this),this.sound&&this.sound.removeEventListener(egret.Event.COMPLETE,this.__soundCompleteHandler,this)},e.prototype.__noticeBtnHandler=function(){(new StopServerTipPop).show(),this.soundLoaded&&this.sound&&this.sound.play(0,1)},e.prototype.initData=function(){this.responseData=LoadingManager.instance.loginData,this.responseData&&(this.serverData=this.responseData.s[0]),this.updateServer()},e.prototype.updateServer=function(){this.serverData&&(this.serverIdTxt.text=this.serverData.an,2==this.serverData.s?this.hotImg.texture=RES.getRes("selectserver_json.close_server_png"):this.serverData.aid>LoadingManager.instance.SERVER_MAX_ID-5?this.hotImg.texture=RES.getRes("selectserver_json.new_server_png"):this.hotImg.texture=RES.getRes("selectserver_json.hot_server_png"))},e.prototype.show=function(){LoadingLayer.instance.addToLayer(this),this.checkNotice()&&this.__noticeBtnHandler()},e.prototype.__ageBtnHandler=function(){var t=new AgeTipsPop;t.show()},e.prototype.checkNotice=function(){var t=LoadingManager.instance.loginData.notice;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t=[]}for(var i,n=t&&t.length||0,r=0;n>r;r++)if(i=t[r],i&&1==i.p1)return!0;return!1},e.prototype.__soundCompleteHandler=function(t){this.soundLoaded=!0},e.prototype.__startGameHandler=function(t){if(htgPlatSdk.gameReport(LoadingConst.POINT_REPORT,{pointtype:"TASK",pointid:8,pointnum:105}),LoadingManager.instance.gameReport(105),this.soundLoaded&&this.sound&&this.sound.play(0,1),!this.serverData)return void LoadingAlert.show("يرجى تحديد سيرفر المنطقة!",null,LoadingAlert.YES);if(2==this.serverData.s&&!LoadingConst.DEBUG)return void LoadingAlert.show(LoadingManager.instance.getMsgPrompt(8),null,LoadingAlert.YES);if(!LoadingManager.instance.openId)return void LoadingAlert.show("openId فارغ!",null,LoadingAlert.YES);if(this.agreementView&&!this.agreementView.selected)return void LoadingAlert.show(LoadingConst.MSG_12,null,LoadingAlert.YES);if(!this.enterGameing){this.enterGameing=!0,LoadingManager.instance.serverData=this.serverData;var e=LoadingManager.instance.openId,i=this.serverData.id,n=this.serverData.an,r=this.serverData.aid,s=LoadingConst.getUIDUrl(i,e,n,r);this.request=new egret.HttpRequest,this.request.responseType=egret.HttpResponseType.TEXT,this.request.open(s,egret.HttpMethod.GET),this.request.addEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.addEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this),this.request.send()}},e.prototype.__getUidCompleteHandler=function(t){this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this);var e=JSON.parse(this.request.response);if(e){var i=e.c||0,n=e.time||0;if(this.getIsOpenSever()){var r=LoadingManager.instance.loginData.s&&LoadingManager.instance.loginData.s[0].planopentime;if(r>n){var s=LoadingManager.instance.loginData.s&&LoadingManager.instance.loginData.s[0].time&&LoadingManager.formatDateBySec(LoadingManager.instance.loginData.s[0].planopentime)||"";return LoadingAlert.show(s,void 0,LoadingAlert.YES),void(this.enterGameing=!1)}}if(1!=i)return 7==i?(this.enterGameing=!1,void LoadingManager.instance.enterSelectRole(this.dispose,this.updateState,this)):(LoadingAlert.show(LoadingManager.instance.getMsgPrompt(i),void 0,LoadingAlert.YES),void(this.enterGameing=!1));LoadingManager.instance.uid=parseInt(e.u),LoadingManager.instance.newbie=e.newbie,LoadingManager.instance.loginKey=e.k,LoadingManager.instance.chatKey=e.chatkey,LoadingManager.instance.ip=e.cip,LoadingManager.instance.port=e.cpt,e.wacts&&(LoadingManager.instance.wacts=e.wacts),LoadingManager.instance.enterGame(),this.dispose()}},e.prototype.updateState=function(){this.enterGameing=!1},e.prototype.__getUidErrorHandler=function(t){this.destory||(this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this),LoadingAlert.show("فشل في الحصول على معلومات المستخدم!",void 0,LoadingAlert.YES),LoadingManager.instance.errReport(3,"获取失败"),this.enterGameing=!1)},e.prototype.__changeServerHandkler=function(t){if(this.getIsOpenSever()){var e=LoadingManager.instance.loginData.s&&LoadingManager.instance.loginData.s[0].time&&LoadingManager.formatDateBySec(LoadingManager.instance.loginData.s[0].planopentime)||"";return void LoadingAlert.show(e,void 0,LoadingAlert.YES)}this.responseData&&!this.enterGameing&&(this.changeFrame||(this.changeFrame=new ChangeServerFrame(this.responseData.s)),this.changeFrame.show(this.__serverChangeHandler,this))},e.prototype.__serverChangeHandler=function(t){t&&(this.serverData!=t&&this.reportSelectServer(t),this.serverData=t,this.updateServer())},e.prototype.__clearCacheHandler=function(t){LoadingAlert.show("هل تريد مسح ذاكرة التخزين المؤقت؟",void 0,void 0,this.__confirmClearHandler,this)},e.prototype.__confirmClearHandler=function(){"function"==typeof htgPlatSdk.clearTempCache&&htgPlatSdk.clearTempCache()},e.prototype.getIsOpenSever=function(){var t=LoadingManager.instance.loginData;return t.s&&1==t.s.length&&0==t.s[0].s?!0:!1},e.prototype.reportSelectServer=function(t){if(t){var e;try{e=JSON.parse(t.userdata||"{}")}catch(i){e=null}if(e){var n={};n.roleName=e.name||"",n.areaId=t.aid||"0",n.areaName=t.an||"",n.roleLevel="0",n.roleId=LoadingManager.instance.uid||"0",n.moneyNum="0",n.vipGrade="0",n.rolePower="0",LoadingConst.IS_REPORT_SELECT_SER=!0,htgPlatSdk.gameReport(LoadingConst.REGISTER_REPORT,n)}}},e.prototype.dispose=function(){this.destory||(this.enterGameing=!1,this.removeEvent(),LoadingConst.disposeObject(this.btnMc),this.btnMc=null,LoadingConst.disposeObject(this.startGameBtn),this.startGameBtn=null,LoadingConst.disposeObject(this.hotImg),this.hotImg=null,LoadingConst.disposeObject(this.clickChangeImg),this.clickChangeImg=null,LoadingConst.disposeObject(this.versionTxt),this.versionTxt=null,this.serverIdTxt.visible=!1,LoadingConst.disposeObject(this.serverIdTxt),this.serverIdTxt=null,LoadingConst.disposeObject(this.changeFrame),this.changeFrame=null,this.request&&(this.request.removeEventListener(egret.Event.COMPLETE,this.__getUidCompleteHandler,this),this.request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.__getUidErrorHandler,this)),this.request=null,this.responseData=null,this.serverData=null,this.bgSoundHandler&&this.bgSoundHandler.stop(),LoadingConst.disposeObject(this.bgSoundHandler),this.bgSoundHandler=null,LoadingConst.disposeObject(this.sound),this.sound=null,LoadingConst.disposeObject(this.soundLoaded),this.soundLoaded=null,LoadingConst.disposeObject(this.agreementView),this.agreementView=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(SelectServerFrame.prototype,"SelectServerFrame");var ServerItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName=e.getSelfSkins(),e}return __extends(e,t),e.prototype.getSelfSkins=function(){var t=new eui.Skin;t.width=282,t.height=78,t.skinParts=["backImg","stateImg","serverNameTxt","tagImg"];var e=new eui.Image;e.touchEnabled=!1,e.source="selectserver_json.change_server_back4_png",e.x=e.y=0,e.height=80,t.backImg=e;var i=new eui.Image;i.touchEnabled=!1,i.source="selectserver_json.hot_server_png",i.x=22,i.y=27,t.stateImg=i;var n=new eui.Image;n.touchEnabled=!1,n.source="selectserver_json.selectserver_rect_png",n.x=0,n.y=0,t.tagImg=n;var r=new eui.Label;return r.size=18,r.fontFamily="SimHei",r.textColor=16380887,r.textAlign=egret.HorizontalAlign.LEFT,r.verticalAlign=egret.VerticalAlign.MIDDLE,r.touchEnabled=!1,r.lineSpacing=1,r.width=125,r.height=80,r.x=150,r.y=0,t.serverNameTxt=r,t.elementsContent=[e,i,r,n],t},e.prototype.initEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removeFromStageHandler,this)},e.prototype.removeEvent=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removeFromStageHandler,this)},e.prototype.initData=function(){this.dataChanged()},e.prototype.dataChanged=function(){if(this.initFinish&&this.data){this.serverInfo=this.data,2==this.serverInfo.s?(this.stateImg.source="selectserver_json.close_server_png",this.tagImg.source="",this.serverNameTxt.textColor=7040110):(this.serverNameTxt.textColor=16380887,2==LoadingManager.instance.SERVER_MAX_ID?this.serverInfo.aid>LoadingManager.instance.SERVER_MAX_ID-1?(this.stateImg.source="selectserver_json.new_server_png",this.tagImg.source="selectserver_json.selectserver_rect_png"):(this.stateImg.source="selectserver_json.hot_server_png",this.tagImg.source=""):this.serverInfo.aid>LoadingManager.instance.SERVER_MAX_ID-2?(this.stateImg.source="selectserver_json.new_server_png",this.tagImg.source="selectserver_json.selectserver_rect_png"):(this.stateImg.source="selectserver_json.hot_server_png",this.tagImg.source=""));var t=this.serverInfo.an;try{var e=this.serverInfo.userdata&&JSON.parse(this.serverInfo.userdata||"{}");e&&e.name?(t+="\n<font size='16' color='#41ff28'>"+e.name+"</font>",!!e.grade&&(t+="\n<font size='16' color='#41ff28'>"+e.grade+"</font>")):this.serverInfo.time&&(t+="\n<font size='16' color='#41ff28'>"+LoadingManager.formatDateBySec(this.serverInfo.planopentime)+"</font>")}catch(i){}finally{this.serverNameTxt.textFlow=LoadingConst.getHtmlFlow(t)}}},e.prototype.__removeFromStageHandler=function(t){this.dispose()},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.stateImg),this.stateImg=null,LoadingConst.disposeObject(this.tagImg),this.tagImg=null,LoadingConst.disposeObject(this.serverNameTxt),this.serverNameTxt=null,this.serverInfo=null,t.prototype.dispose.call(this))},e}(LoadingBaseItemRenderer);__reflect(ServerItemRenderer.prototype,"ServerItemRenderer");var StopServerTipItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=e.getSelfSkin(),e}return __extends(e,t),e.prototype.getSelfSkin=function(){var t=new eui.Skin;t.width=115,t.height=46,t.skinParts=["titleTxt","selImg","unselImg"];var e=new eui.Image;e.touchEnabled=!1,e.source="selectserver_json.selectserver_btn_2_png",t.selImg=e;var i=new eui.Image;i.touchEnabled=!1,i.visible=!1,i.source="selectserver_json.selectserver_btn_1_png",i.y=6,t.unselImg=i;var n=new eui.Label;n.size=20,n.horizontalCenter=0,n.verticalCenter=3,n.textColor=739972,t.titleTxt=n,t.elementsContent=[e,i,n];var r=new eui.SetProperty("selImg","visible",!1),s=new eui.SetProperty("selImg","visible",!1),o=new eui.SetProperty("unselImg","visible",!0),a=new eui.SetProperty("unselImg","visible",!0),h=new eui.SetProperty("titleTxt","textColor",12642298),l=new eui.SetProperty("titleTxt","textColor",12642298);return t.states=[new eui.State("up",[r,o,h]),new eui.State("down",[s,a,l]),new eui.State("upAndSelected"),new eui.State("downAndSelected")],t},e.prototype.initView=function(){},e.prototype.initEvent=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removedHandler,this)},e.prototype.removeEvent=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.__removedHandler,this)},e.prototype.initData=function(){this.dataChanged()},e.prototype.dataChanged=function(){this.initFinish&&this.data&&(this.info=this.data,this.titleTxt.text=this.info.title||"")},e.prototype.__removedHandler=function(t){LoadingConst.disposeObject(this)},e.prototype.dispose=function(){this.destory||(this.removeEvent(),LoadingConst.disposeObject(this.titleTxt),this.titleTxt=null,LoadingConst.disposeObject(this.selImg),this.selImg=null,LoadingConst.disposeObject(this.unselImg),this.unselImg=null,this.info=null,t.prototype.dispose.call(this))},e}(LoadingBaseItemRenderer);__reflect(StopServerTipItem.prototype,"StopServerTipItem");var StopServerTipPop=function(t){function e(){var e=t.call(this,"StopServerTipPop")||this;return e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.initView=function(){this.width=540,this.height=647,this.backImg=new eui.Image,this.backImg.touchEnabled=!1,this.backImg.source="login_notice_back_png",this.addChild(this.backImg),this.nameTxt=new eui.Label,this.nameTxt.width=300,this.nameTxt.size=20,this.nameTxt.textColor=11556609,this.nameTxt.touchEnabled=!1,this.nameTxt.textAlign="center",this.nameTxt.x=120,this.nameTxt.y=61,this.addChild(this.nameTxt),this.scroller=new eui.Scroller,this.scroller.width=440,this.scroller.height=465,this.scroller.x=50,this.scroller.y=93,this.scroller.scrollPolicyH="off",this.addChild(this.scroller),this.contentTxt=new eui.Label,this.contentTxt.size=18,this.contentTxt.textColor=8996883,this.contentTxt.lineSpacing=8,this.contentTxt.width=440,this.contentTxt.x=0,this.contentTxt.y=0,this.bannerImg=new eui.Image,this.bannerImg.y=0,this.bannerImg.horizontalCenter=0,this.contentGroup=new eui.Group,this.contentGroup.width=440,this.contentGroup.addChild(this.bannerImg),this.contentGroup.addChild(this.contentTxt),this.scroller.viewport=this.contentGroup,this.txtParser=new egret.HtmlTextParser},e.prototype.initEvent=function(){this.btnList&&this.btnList.addEventListener(egret.Event.CHANGE,this.__btnChangedHandler,this),this.btnScroller&&this.btnScroller.addEventListener(egret.Event.CHANGE,this.__scrollerHandler,this)},e.prototype.removeEvent=function(){this.btnList&&this.btnList.removeEventListener(egret.Event.CHANGE,this.__btnChangedHandler,this),this.btnScroller&&this.btnScroller.removeEventListener(egret.Event.CHANGE,this.__scrollerHandler,this)},e.prototype.initData=function(){var t=LoadingManager.instance.loginData.notice;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){t=[]}this.noticeData=t,this.noticeData&&this.noticeData.length&&this.updateBtnList()},e.prototype.updateBtnList=function(){var t=this.noticeData.length;t>1?(this.scroller.height=465,this.initBtnListComp(t),this.initEvent(),this.noticeData.sort(function(t,e){return t.sort>e.sort?-1:1}),this.btnDatas.replaceAll(this.noticeData.concat()),this.btnList.selectedIndex=0,this.__btnChangedHandler(null),egret.Tween.get(this).wait(50).call(this.__scrollerHandler,this)):(this.scroller.height=520,this.updateView(this.noticeData[0]))},e.prototype.__btnChangedHandler=function(t){var e=this.btnList.selectedItem;this.updateView(e)},e.prototype.__scrollerHandler=function(t){if(this.btnScroller){var e=this.btnScroller.viewport.scrollH,i=this.btnScroller.viewport.contentWidth-this.btnScroller.width;this.leftImg.visible=e>0,this.rightImg.visible=i>e}},e.prototype.updateView=function(t){t&&(this.nameTxt.text=t.name||LoadingConst.MSG_8,this.html2flow(this.contentTxt,t.detail),t.banner?(this.bannerImg.source=LoadingConst.res_path+"icons/loginbanner/"+t.banner+".jpg",this.contentTxt.y=120,this.bannerImg.visible=!0):(this.bannerImg.visible=!1,this.contentTxt.y=0))},e.prototype.initBtnListComp=function(t){this.btnBackImg=new eui.Image,this.btnBackImg.source="selectserver_json.selectserver_list_back_png",this.btnBackImg.scale9Grid=new egret.Rectangle(17,4,50,44),this.btnBackImg.width=481,this.btnBackImg.x=30,this.btnBackImg.y=563,this.addChild(this.btnBackImg);var e=new eui.HorizontalLayout;
e.gap=3,this.btnList=new eui.List,this.btnList.layout=e,this.btnList.width=430,this.btnList.height=46,this.btnList.x=55,this.btnList.y=564,this.addChild(this.btnList),this.btnDatas=new eui.ArrayCollection,this.btnList.dataProvider=this.btnDatas,this.btnList.itemRenderer=StopServerTipItem,t>=4&&(this.btnScroller=new eui.Scroller,this.btnScroller.width=430,this.btnScroller.height=46,this.btnScroller.x=55,this.btnScroller.y=564,this.btnScroller.viewport=this.btnList,this.addChild(this.btnScroller),this.leftImg=new eui.Image,this.leftImg.source="selectserver_json.selectserver_left_png",this.leftImg.x=30,this.leftImg.y=570,this.leftImg.visible=!1,this.addChild(this.leftImg),this.rightImg=new eui.Image,this.rightImg.source="selectserver_json.selectserver_left_png",this.rightImg.scaleX=-1,this.rightImg.x=510,this.rightImg.y=570,this.leftImg.visible=!1,this.addChild(this.rightImg))},e.prototype.html2flow=function(t,e){if(!e)return null;var i;try{i=LoadingConst.parserHtml(e)}catch(n){e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),i=LoadingConst.parserHtml(e)}var r=[i[0]];if(i.length>1)for(var s=1;s<i.length;s++)r[0].text+=i[s].text;return r[0].style=void 0,t&&(t.textFlow=r),r},e.prototype.autoTouchClose=function(){return!0},e.prototype.show=function(){!this.parent&&LoadingLayer.instance.addToLayer(this,1)},e.prototype.dispose=function(){this.destory||(this.removeEvent(),egret.Tween.removeTweens(this),LoadingConst.disposeObject(this.backImg),this.backImg=null,LoadingConst.disposeObject(this.btnBackImg),this.btnBackImg=null,LoadingConst.disposeObject(this.contentTxt),this.contentTxt=null,LoadingConst.disposeObject(this.contentGroup),this.contentGroup=null,LoadingConst.disposeObject(this.leftImg),this.leftImg=null,LoadingConst.disposeObject(this.rightImg),this.rightImg=null,LoadingConst.disposeObject(this.nameTxt),this.nameTxt=null,this.scroller&&(this.scroller.stopAnimation(),this.scroller.viewport=null,LoadingConst.disposeObject(this.scroller)),this.scroller=null,this.btnScroller&&(this.btnScroller.stopAnimation(),this.btnScroller.viewport=null,LoadingConst.disposeObject(this.btnScroller)),this.btnScroller=null,this.btnList&&(this.btnList.dataProvider=null,LoadingConst.disposeObject(this.btnList)),this.btnList=null,this.btnDatas=null,this.noticeData=null,this.txtParser=null,LoadingConst.disposeObject(this.bannerImg),this.bannerImg=null,t.prototype.dispose.call(this))},e}(LoadingBaseUI);__reflect(StopServerTipPop.prototype,"StopServerTipPop");var HtgJsonProcessor=function(){function t(t){this.isReplace=!!t}return t.prototype.onLoadStart=function(t,e){var i=this;return t.load(e,"text").then(function(t){t&&i.isReplace&&(t=t.replace(/\/-[^-]+-\//gi,'"'));try{var n=JSON.parse(t);return n}catch(r){console.error("json解析错误！"+e.root+e.url)}return null})},t.prototype.onRemoveStart=function(t,e){},t}();__reflect(HtgJsonProcessor.prototype,"HtgJsonProcessor",["RES.processor.Processor"]);var NativeUrlController=function(){function t(){}return t.prototype.init=function(){return this.resRoot=htgPlatSdk.getResPath(),console.log("初始化资源地址映射！配置文件加载："+!!t.versionInfo),Promise.resolve()},t.prototype.getVirtualUrl=function(e){var i,n=this.getRelativePath(e),r=t.versionInfo&&t.versionInfo[n]||null;if(r){var s=e.match(/#.*|\?.*/),o="";s&&(o=s[0]),i=this.resRoot+r+o}return i||e},t.prototype.getRelativePath=function(t){var e=t.split("\\").join("/");e=e.replace(this.resRoot,"");var i=e.indexOf("?");return i>=0&&(e=e.substring(0,i)),e},t.prototype.getLocalData=function(t){return null},t}();__reflect(NativeUrlController.prototype,"NativeUrlController",["RES.IVersionController"]);var LegacyResConfigProcessor=function(){function t(){}return t.prototype.onLoadStart=function(t,e){return t.load(e,"json").then(function(i){var n=RES.config.config,r=e.root,s=n.fileSystem;s||(s={fsData:{},getFile:function(t){return d[t]},addFile:function(t){t.type||(t.type=""),void 0==r&&(t.root=""),d[t.name]=t},profile:function(){console.log(d)},removeFile:function(t){delete d[t]}},n.fileSystem=s);for(var o=n.groups,a=0,h=i.groups;a<h.length;a++){var l=h[a];o[l.name]&&console.error("存在相同的资源组：",l.name),""==l.keys?o[l.name]=[]:o[l.name]=l.keys.split(",")}for(var c=n.alias,d=s.fsData,g=function(t){d[t.name]&&console.error("存在相同一级key:",t.name),d[t.name]=t,d[t.name].root=r,t.subkeys&&t.subkeys.split(",").forEach(function(e){var i=t.name+"#"+e;c[e],c[e]=i,c[t.name+"."+e]=t.name+"#"+e})},u=0,p=i.resources;u<p.length;u++){var _=p[u];g(_)}return t.save(e,i),i})},t.prototype.onRemoveStart=function(){},t}();__reflect(LegacyResConfigProcessor.prototype,"LegacyResConfigProcessor",["RES.processor.Processor"]);